import{j as e}from"./ui-vendor-S6RcKJ66.js";import{R as t,b as a}from"./react-vendor-Bp2pLdQf.js";import{D as n}from"./CustomSelect-BGZwvjj5.js";function r(e){if(!e)return!1;try{const[t,a,n]=e.split("-");if(!t||!a||!n)return!1;const r=parseInt(t),s=parseInt(a),l=parseInt(n);if(s<1||s>12)return!1;if(l<1||l>31)return!1;const i=new Date(r,s-1,l);return i.getFullYear()===r&&i.getMonth()===s-1&&i.getDate()===l}catch{return!1}}const s=()=>{if("undefined"!=typeof window&&"undefined"!=typeof localStorage){const e=localStorage.getItem("theme");if("light"===e||"dark"===e)return e}return"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},l=t.forwardRef(({id:t,value:l,onChange:i,label:c,placeholder:d="gg/mm/aaaa",description:o,isDisabled:u=!1,isRequired:p=!1,isInvalid:m=!1,errorMessage:h,minValue:g,maxValue:f,size:v="md",className:x,inputClassName:k,allowInput:w=!0,clearable:b=!0,autoFocus:y=!1},j)=>{const[D,S]=a.useState(!1),[N,$]=a.useState(()=>s()),[M,C]=a.useState(()=>"undefined"!=typeof window&&window.innerWidth<=576),[E,Y]=a.useState(()=>{if(l){const[e,t]=l.split("-");return new Date(parseInt(e),parseInt(t)-1)}return new Date}),[L,F]=a.useState(null);a.useEffect(()=>{const e=window.matchMedia("(max-width: 576px)"),t=e=>{C(e.matches)};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}},[]),a.useEffect(()=>{const e=()=>{$(s())},t=t=>{"theme"!==t.key&&null!==t.key||e()};window.addEventListener("storage",t);const a=()=>{setTimeout(e,10)};document.addEventListener("theme-change",a),window.addEventListener("theme-change",a);const n=window.matchMedia("(prefers-color-scheme: dark)"),r=t=>{e()};return n.addEventListener("change",r),e(),()=>{window.removeEventListener("storage",t),document.removeEventListener("theme-change",a),window.removeEventListener("theme-change",a),n.removeEventListener("change",r)}},[]),a.useEffect(()=>{if(D&&j&&"current"in j&&j.current){const e=j.current,t=e?.querySelector(".datepicker-input-group"),a=e?.querySelector(".datepicker-calendar-popup");e&&t&&a&&n.calculateAndApply(e,t,a)}},[D,j]),a.useEffect(()=>{const e=e=>{"Escape"===e.key&&D&&(e.preventDefault(),S(!1))};if(D)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[D]),a.useEffect(()=>{const e=e=>{if(j&&"current"in j){const t=j.current;t&&!t.contains(e.target)&&S(!1)}};if(D&&j&&"current"in j&&j.current)return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[D,j]);const I=a.useMemo(()=>l?function(e){if(!e)return"";try{const[t,a,n]=e.split("-");return t&&a&&n?`${n}/${a}/${t}`:""}catch{return""}}(l):"",[l]),A={sm:"form-control-sm",md:"",lg:"form-control-lg"}[v],R=`datepicker-${v}`,V=a.useCallback(e=>{const t=e.target.value;if(!t)return i(null),void 0;const a=function(e){if(!e)return"";const t=e.trim(),a=t.match(/^(\d{1,2})[\/-](\d{1,2})[\/-](\d{4})$/);if(a){const[,e,t,n]=a,r=String(e).padStart(2,"0");return`${n}-${String(t).padStart(2,"0")}-${r}`}const n=t.match(/^(\d{4})[-/](\d{1,2})[-/](\d{1,2})$/);if(n){const[,e,t,a]=n,r=String(a).padStart(2,"0");return`${e}-${String(t).padStart(2,"0")}-${r}`}return""}(t);r(a)&&i(a)},[i]),q=a.useCallback(e=>{const t=e.target.value;if(!t)return i(null),void 0;r(t)&&i(t)},[i]),z=a.useCallback(()=>{i(null)},[i]),P=a.useCallback(e=>{const t=`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`;i(t),S(!1)},[E,i]),T=a.useCallback(()=>{Y(e=>new Date(e.getFullYear(),e.getMonth()-1))},[]),W=a.useCallback(()=>{Y(e=>new Date(e.getFullYear(),e.getMonth()+1))},[]),B=a.useMemo(()=>{const e=E.getFullYear(),t=E.getMonth(),a=new Date(e,t,1),n=new Date(e,t+1,0).getDate(),r=a.getDay(),s=[];for(let l=0;l<r;l++)s.push(null);for(let l=1;l<=n;l++)s.push(l);return s},[E]),O=a.useMemo(()=>{const e=(new Date).getFullYear(),t=[];for(let a=e-100;a<=e+10;a++)t.push(a);return t},[]),G=a.useMemo(()=>Array.from({length:12},(e,t)=>{const a=new Date(2025,t);return{value:t,label:new Intl.DateTimeFormat("it-IT",{month:"long"}).format(a)}}),[]),K=a.useCallback(e=>{const t=parseInt(e.target.value);Y(e=>new Date(e.getFullYear(),t))},[]),U=a.useCallback(e=>{const t=parseInt(e.target.value);Y(e=>new Date(t,e.getMonth()))},[]),H=a.useCallback(e=>{if("Escape"===e.key&&D)e.preventDefault(),S(!1);else if(D&&"ArrowUp"===e.key)if(e.preventDefault(),L){const e=L-7;e>0&&F(e)}else F(1);else if(D&&"ArrowDown"===e.key)if(e.preventDefault(),L){const e=L+7;e<=31&&F(e)}else F(1);else if(D&&"ArrowLeft"===e.key){if(e.preventDefault(),L&&L>1)F(L-1);else if(1===L){const e=new Date(E.getFullYear(),E.getMonth(),0).getDate();Y(new Date(E.getFullYear(),E.getMonth()-1)),F(e)}}else if(D&&"ArrowRight"===e.key){e.preventDefault();const t=new Date(E.getFullYear(),E.getMonth()+1,0).getDate();L&&L<t?F(L+1):L===t&&(Y(new Date(E.getFullYear(),E.getMonth()+1)),F(1))}else if(D&&"Enter"===e.key&&L){e.preventDefault();const t=`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(L).padStart(2,"0")}`;i(t),S(!1),F(null)}},[D,L,E,i]);return e.jsxs("div",{ref:j,className:`datepicker-wrapper ${R} datepicker-${N} ${x||""}`,children:[c&&e.jsxs("label",{className:"form-label",htmlFor:t,children:[c,p&&e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx("div",{className:"datepicker-input-group "+(m?"is-invalid":""),children:M?e.jsx("input",{id:t,type:"date",className:`form-control ${A} datepicker-input native-date-input ${k||""} ${m?"is-invalid":""}`,value:l||"",onChange:q,disabled:u,autoFocus:y,min:g?String(g):void 0,max:f?String(f):void 0}):e.jsxs(e.Fragment,{children:[e.jsx("input",{id:t,type:"text",className:`form-control ${A} datepicker-input ${k||""} ${m?"is-invalid":""}`,placeholder:d,value:I,onChange:V,onKeyDown:H,disabled:u,autoFocus:y,readOnly:!w}),e.jsx("button",{type:"button",className:"datepicker-trigger-btn",onClick:()=>S(!D),disabled:u,"aria-label":"Apri date picker",children:e.jsxs("svg",{className:"datepicker-icon",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}),b&&I&&e.jsx("button",{type:"button",className:"datepicker-clear-btn",onClick:z,disabled:u,"aria-label":"Cancella data",children:e.jsxs("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}),o&&e.jsx("small",{className:"form-text",children:o}),m&&h&&e.jsx("div",{className:"invalid-feedback d-block",children:h}),D&&!u&&!M&&e.jsx("div",{className:"datepicker-calendar-popup",children:e.jsxs("div",{className:"datepicker-calendar",children:[e.jsxs("div",{className:"datepicker-calendar-header",children:[e.jsx("button",{type:"button",className:"datepicker-nav-btn datepicker-nav-prev",onClick:T,"aria-label":"Mese precedente",children:"←"}),e.jsxs("div",{className:"datepicker-dropdown-controls",children:[e.jsx("select",{className:"datepicker-month-select",value:E.getMonth(),onChange:K,"aria-label":"Seleziona mese",children:G.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("select",{className:"datepicker-year-select",value:E.getFullYear(),onChange:U,"aria-label":"Seleziona anno",children:O.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx("button",{type:"button",className:"datepicker-nav-btn datepicker-nav-next",onClick:W,"aria-label":"Mese successivo",children:"→"})]}),e.jsxs("table",{className:"datepicker-calendar-grid",children:[e.jsx("thead",{children:e.jsx("tr",{children:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"].map(t=>e.jsx("th",{className:"datepicker-weekday",children:t},t))})}),e.jsx("tbody",{children:Array.from({length:Math.ceil(B.length/7)},(t,a)=>e.jsx("tr",{className:"datepicker-week",children:Array.from({length:7},(t,n)=>{const r=B[7*a+n];if(null===r)return e.jsx("td",{className:"datepicker-day-cell"},n);const s=`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`,i=l===s,c=s===(new Date).toISOString().split("T")[0];return e.jsx("td",{className:"datepicker-day-cell",children:e.jsx("button",{type:"button",className:`datepicker-day ${i?"selected":""} ${c?"today":""} ${L===r?"focused":""}`,onClick:()=>P(r),children:r})},n)})},a))})]})]})})]})});l.displayName="DatePicker";const i=t.forwardRef(({startDate:t,endDate:a,onStartDateChange:n,onEndDateChange:r,startLabel:s="Start Date",endLabel:i="End Date",startPlaceholder:c="DD/MM/YYYY",endPlaceholder:d="DD/MM/YYYY",description:o,isDisabled:u=!1,isRequired:p=!1,isInvalid:m=!1,errorMessage:h,minValue:g,maxValue:f,size:v="md",className:x,allowInput:k=!0,clearable:w=!0},b)=>{const y=(()=>{if(!t||!a)return!0;try{const e=new Date(t);return e<=new Date(a)}catch{return!1}})(),j=m||!y;return e.jsxs("div",{ref:b,className:`date-range-picker-wrapper ${x||""}`,"aria-describedby":o?"daterange-description":void 0,children:[o&&e.jsx("p",{id:"daterange-description",className:"form-text mb-2",children:o}),e.jsxs("div",{className:"date-range-inputs",children:[e.jsx("div",{className:"date-range-input-group",children:e.jsx(l,{value:t,onChange:n,label:s,placeholder:c,isDisabled:u,isRequired:p,minValue:g,maxValue:f,size:v,allowInput:k,clearable:w,isInvalid:j})}),e.jsx("div",{className:"date-range-separator",children:"→"}),e.jsx("div",{className:"date-range-input-group",children:e.jsx(l,{value:a,onChange:r,label:i,placeholder:d,isDisabled:u,isRequired:p,minValue:g,maxValue:f,size:v,allowInput:k,clearable:w,isInvalid:j})})]}),j&&!y&&e.jsx("div",{className:"invalid-feedback d-block",children:"La data di inizio deve essere prima della data di fine"}),j&&h&&e.jsx("div",{className:"invalid-feedback d-block",children:h})]})});i.displayName="DateRangePicker";export{l as D,i as a};

class t{infectionData=null;isValid=!1;validationErrors=[];constructor(){this.infectionData=null,this.isValid=!1,this.validationErrors=[]}setInfectionData(t){if(!t)return this.clearInfectionData(),void 0;this.infectionData={data_evento:t.data_evento||"",agente_patogeno:t.agente_patogeno||null,agente_patogeno_id:t.agente_patogeno_id??null,tipo_patogeno:t.tipo_patogeno||null,descrizione:t.descrizione||null,note:t.note||null,data_fine_evento:t.data_fine_evento||null,timestamp:Date.now()},this.validateInfectionData(this.infectionData)}getInfectionData(){return this.infectionData?{...this.infectionData}:null}clearInfectionData(){this.infectionData=null,this.isValid=!1,this.validationErrors=[]}hasValidInfectionData(){return null!==this.infectionData&&this.isValid}hasInfectionData(){return null!==this.infectionData}validateInfectionData(t){if(this.validationErrors=[],!t)return this.isValid=!1,!1;if(t.data_evento){const e=new Date(t.data_evento),a=new Date;a.setHours(23,59,59,999),isNaN(e.getTime())?this.validationErrors.push({field:"data_evento",message:"Formato data non valido"}):e>a&&this.validationErrors.push({field:"data_evento",message:"La data dell'infezione non può essere futura"})}else this.validationErrors.push({field:"data_evento",message:"La data dell'infezione è obbligatoria"});if(!!t.agente_patogeno&&t.agente_patogeno.trim().length>0||!!t.agente_patogeno_id||!!t.tipo_patogeno||this.validationErrors.push({field:"agente_patogeno",message:"L'agente patogeno o il tipo patogeno è obbligatorio"}),t.agente_patogeno&&"string"==typeof t.agente_patogeno){const e=t.agente_patogeno.trim().length;e>0&&e<2?this.validationErrors.push({field:"agente_patogeno",message:"L'agente patogeno deve avere almeno 2 caratteri"}):e>100&&this.validationErrors.push({field:"agente_patogeno",message:"L'agente patogeno non può superare i 100 caratteri"})}return t.descrizione&&t.descrizione.length>500&&this.validationErrors.push({field:"descrizione",message:"La descrizione non può superare i 500 caratteri"}),this.isValid=0===this.validationErrors.length,this.isValid}getValidationErrors(){return[...this.validationErrors]}getFieldErrors(t){return this.validationErrors.filter(e=>e.field===t)}hasFieldError(t){return this.validationErrors.some(e=>e.field===t)}getStatus(){return{hasData:this.hasInfectionData(),isValid:this.isValid,errorCount:this.validationErrors.length,timestamp:this.infectionData?.timestamp||null}}cleanupExpiredData(){if(this.infectionData&&this.infectionData.timestamp){const t=Date.now()-36e5;if(this.infectionData.timestamp<t)return this.clearInfectionData(),!0}return!1}}const e=new t;export{t as InfectionDataManager,e as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-qxKMwVtJ.js","assets/ui-vendor-S6RcKJ66.js","assets/react-vendor-Bp2pLdQf.js","assets/patientService-BOCGDPYj.js","assets/CentralizedStatisticsService-1uNAbCs6.js","assets/supabase-Zkii_ZbW.js","assets/index-UIQkchGv.css","assets/LoginPage-v1z-YCd-.js","assets/LoginPage-CR1RlFUN.css","assets/PatientFormPage-DmfkuKq1.js","assets/Button-DebNsbwT.js","assets/CustomSelect-CrF01Zkf.js","assets/dropdownPositioner-CpLmXRgY.js","assets/DateRangePicker-Bh5ogQO-.js","assets/DateRangePicker-BpE3fgus.css","assets/InterventionForm-CJJMaUD_.js","assets/useNotification-DOfvwS3b.js","assets/filterQueryService-DuGIbeZ3.js","assets/WizardStepper-wmT1Y9zi.js","assets/WizardStepper-DrJuGQbR.css","assets/useResponsive-DNmHy4-N.js","assets/PatientFormPage-CeZ8QXUs.css","assets/PatientListPage-BFTg1o-K.js","assets/useQuery-PLrmMRDS.js","assets/useMutation-DOJimrkR.js","assets/ConfirmModal-DrSmdxuC.js","assets/DischargePage-v_iMbvup.js","assets/index-CeQ8WJMT.js","assets/charts-vendor-BWtMAC_w.js","assets/index-DvXcFARa.css","assets/DiagnosiPage-DqZgSn43.js","assets/EventsPage-NK1u2TxF.js","assets/EventFormWizard-DSAe5aNI.js","assets/EventFormWizard-B9GjFT9G.css","assets/EventsPage-tn0RQdqM.css","assets/EventWizardPage-RsunWXUk.js"])))=>i.map(i=>d[i]);
import{j as e,D as t,C as n,M as i}from"./ui-vendor-S6RcKJ66.js";import{b as o,R as r,N as s,u as a,d as l,e as c,B as u,f as d,h}from"./react-vendor-Bp2pLdQf.js";import{c as m}from"./supabase-Zkii_ZbW.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),t.credentials="use-credentials"===e.crossOrigin?"include":"anonymous"===e.crossOrigin?"omit":"same-origin",t}(e);fetch(e.href,t)}}();const f={},p=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),o=n?.nonce||n?.getAttribute("nonce");i=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in f)return;f[e]=!0;const t=e.endsWith(".css");if(document.querySelector(`link[href="${e}"]${t?'[rel="stylesheet"]':""}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,o&&n.setAttribute("nonce",o),document.head.appendChild(n),t?new Promise((t,i)=>{n.addEventListener("load",t),n.addEventListener("error",()=>i(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then(t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})};var g=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},y={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},b=new class{#e=y;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}};var v="undefined"==typeof window||"Deno"in globalThis;function w(){}function E(e){return"number"==typeof e&&e>=0&&e!==1/0}function S(e,t){return Math.max(e+(t||0)-Date.now(),0)}function _(e,t){return"function"==typeof e?e(t):e}function x(e,t){return"function"==typeof e?e(t):e}function T(e,t){const{type:n="all",exact:i,fetchStatus:o,predicate:r,queryKey:s,stale:a}=e;if(s)if(i){if(t.queryHash!==C(s,t.options))return!1}else if(!O(t.queryKey,s))return!1;if("all"!==n){const e=t.isActive();if("active"===n&&!e)return!1;if("inactive"===n&&e)return!1}return("boolean"!=typeof a||t.isStale()===a)&&((!o||o===t.state.fetchStatus)&&!(r&&!r(t)))}function A(e,t){const{exact:n,status:i,predicate:o,mutationKey:r}=e;if(r){if(!t.options.mutationKey)return!1;if(n){if(k(t.options.mutationKey)!==k(r))return!1}else if(!O(t.options.mutationKey,r))return!1}return(!i||t.state.status===i)&&!(o&&!o(t))}function C(e,t){return(t?.queryKeyHashFn||k)(e)}function k(e){return JSON.stringify(e,(e,t)=>j(t)?Object.keys(t).sort().reduce((e,n)=>(e[n]=t[n],e),{}):t)}function O(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(n=>O(e[n],t[n])))}var N=Object.prototype.hasOwnProperty;function I(e,t){if(e===t)return e;const n=L(e)&&L(t);if(!(n||j(e)&&j(t)))return t;const i=(n?e:Object.keys(e)).length,o=n?t:Object.keys(t),r=o.length,s=n?new Array(r):{};let a=0;for(let l=0;l<r;l++){const r=n?l:o[l],c=e[r],u=t[r];if(c===u){s[r]=c,(n?l<i:N.call(e,r))&&a++;continue}if(null===c||null===u||"object"!=typeof c||"object"!=typeof u){s[r]=u;continue}const d=I(c,u);s[r]=d,d===c&&a++}return i===r&&a===i?e:s}function R(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function L(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function j(e){if(!P(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!!P(n)&&(!!n.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function P(e){return"[object Object]"===Object.prototype.toString.call(e)}function D(e,t,n){return"function"==typeof n.structuralSharing?n.structuralSharing(e,t):!1!==n.structuralSharing?I(e,t):t}function M(e){return e}function z(e,t,n=0){const i=[...e,t];return n&&i.length>n?i.slice(1):i}function q(e,t,n=0){const i=[t,...e];return n&&i.length>n?i.slice(0,-1):i}var F=Symbol();function U(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==F?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function G(e,t){return"function"==typeof e?e(...t):!!e}var B=new class extends g{#n;#i;#o;constructor(){super(),this.#o=e=>{if(!v&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#i||this.setEventListener(this.#o)}onUnsubscribe(){this.hasListeners()||(this.#i?.(),this.#i=void 0)}setEventListener(e){this.#o=e,this.#i?.(),this.#i=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#n!==e&&(this.#n=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#n?this.#n:"hidden"!==globalThis.document?.visibilityState}};function H(){let e,t;const n=new Promise((n,i)=>{e=n,t=i});function i(e){Object.assign(n,e),delete n.resolve,delete n.reject}return n.status="pending",n.catch(()=>{}),n.resolve=t=>{i({status:"fulfilled",value:t}),e(t)},n.reject=e=>{i({status:"rejected",reason:e}),t(e)},n}var W=function(e){setTimeout(e,0)};var $=function(){let e=[],t=0,n=e=>{e()},i=e=>{e()},o=W;const r=i=>{t?e.push(i):o(()=>{n(i)})};return{batch:r=>{let s;t++;try{s=r()}finally{t--,t||(()=>{const t=e;e=[],t.length&&o(()=>{i(()=>{t.forEach(e=>{n(e)})})})})()}return s},batchCalls:e=>(...t)=>{r(()=>{e(...t)})},schedule:r,setNotifyFunction:e=>{n=e},setBatchNotifyFunction:e=>{i=e},setScheduler:e=>{o=e}}}(),Q=new class extends g{#r=!0;#i;#o;constructor(){super(),this.#o=e=>{if(!v&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#i||this.setEventListener(this.#o)}onUnsubscribe(){this.hasListeners()||(this.#i?.(),this.#i=void 0)}setEventListener(e){this.#o=e,this.#i?.(),this.#i=e(this.setOnline.bind(this))}setOnline(e){this.#r!==e&&(this.#r=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#r}};function K(e){return Math.min(1e3*2**e,3e4)}function V(e){return"online"!==(e??"online")||Q.isOnline()}var Y=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function J(e){let t,n=!1,i=0;const o=H(),r=()=>"pending"!==o.status,s=()=>B.isFocused()&&("always"===e.networkMode||Q.isOnline())&&e.canRun(),a=()=>V(e.networkMode)&&e.canRun(),l=e=>{r()||(t?.(),o.resolve(e))},c=e=>{r()||(t?.(),o.reject(e))},u=()=>new Promise(n=>{t=e=>{(r()||s())&&n(e)},e.onPause?.()}).then(()=>{t=void 0,r()||e.onContinue?.()}),d=()=>{if(r())return;let t;const o=0===i?e.initialPromise:void 0;try{t=o??e.fn()}catch(a){t=Promise.reject(a)}Promise.resolve(t).then(l).catch(t=>{if(r())return;const o=e.retry??(v?0:3),a=e.retryDelay??K,l="function"==typeof a?a(i,t):a,h=!0===o||"number"==typeof o&&i<o||"function"==typeof o&&o(i,t);if(n||!h)return c(t),void 0;var m;i++,e.onFail?.(i,t),(m=l,new Promise(e=>{b.setTimeout(e,m)})).then(()=>s()?void 0:u()).then(()=>{n?c(t):d()})})};return{promise:o,status:()=>o.status,cancel:t=>{if(!r()){const n=new Y(t);c(n),e.onCancel?.(n)}},continue:()=>(t?.(),o),cancelRetry:()=>{n=!0},continueRetry:()=>{n=!1},canStart:a,start:()=>(a()?d():u().then(d),o)}}var X=class{#s;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),E(this.gcTime)&&(this.#s=b.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(v?1/0:3e5))}clearGcTimeout(){this.#s&&(b.clearTimeout(this.#s),this.#s=void 0)}},Z=class extends X{#a;#l;#c;#u;#d;#h;#m;constructor(e){super(),this.#m=!1,this.#h=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#u=e.client,this.#c=this.#u.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#a=ne(this.options),this.state=e.state??this.#a,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#d?.promise}setOptions(e){if(this.options={...this.#h,...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=ne(this.options);void 0!==e.data&&(this.setState(te(e.data,e.dataUpdatedAt)),this.#a=e)}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#c.remove(this)}setData(e,t){const n=D(this.state.data,e,this.options);return this.#f({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#f({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#d?.promise;return this.#d?.cancel(e),t?t.then(w).catch(w):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#a)}isActive(){return this.observers.some(e=>!1!==x(e.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===F||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===_(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!S(this.state.dataUpdatedAt,e))}onFocus(){const e=this.observers.find(e=>e.shouldFetchOnWindowFocus());e?.refetch({cancelRefetch:!1}),this.#d?.continue()}onOnline(){const e=this.observers.find(e=>e.shouldFetchOnReconnect());e?.refetch({cancelRefetch:!1}),this.#d?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#c.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#d&&(this.#m?this.#d.cancel({revert:!0}):this.#d.cancelRetry()),this.scheduleGc()),this.#c.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#f({type:"invalidate"})}async fetch(e,t){if("idle"!==this.state.fetchStatus&&"rejected"!==this.#d?.status())if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#d)return this.#d.continueRetry(),this.#d.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const n=new AbortController,i=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#m=!0,n.signal)})},o=()=>{const e=U(this.options,t),n=(()=>{const e={client:this.#u,queryKey:this.queryKey,meta:this.meta};return i(e),e})();return this.#m=!1,this.options.persister?this.options.persister(e,n,this):e(n)},r=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#u,state:this.state,fetchFn:o};return i(e),e})();this.options.behavior?.onFetch(r,this),this.#l=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===r.fetchOptions?.meta||this.#f({type:"fetch",meta:r.fetchOptions?.meta}),this.#d=J({initialPromise:t?.initialPromise,fn:r.fetchFn,onCancel:e=>{e instanceof Y&&e.revert&&this.setState({...this.#l,fetchStatus:"idle"}),n.abort()},onFail:(e,t)=>{this.#f({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#f({type:"pause"})},onContinue:()=>{this.#f({type:"continue"})},retry:r.options.retry,retryDelay:r.options.retryDelay,networkMode:r.options.networkMode,canRun:()=>!0});try{const e=await this.#d.start();if(void 0===e)throw 0,new Error(`${this.queryHash} data is undefined`);return this.setData(e),this.#c.config.onSuccess?.(e,this),this.#c.config.onSettled?.(e,this.state.error,this),e}catch(s){if(s instanceof Y){if(s.silent)return this.#d.promise;if(s.revert){if(void 0===this.state.data)throw s;return this.state.data}}throw this.#f({type:"error",error:s}),this.#c.config.onError?.(s,this),this.#c.config.onSettled?.(this.state.data,s,this),s}finally{this.scheduleGc()}}#f(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...ee(t.data,this.options),fetchMeta:e.meta??null};case"success":const n={...t,...te(e.data,e.dataUpdatedAt),dataUpdateCount:t.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#l=e.manual?n:void 0,n;case"error":const i=e.error;return{...t,error:i,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),$.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#c.notify({query:this,type:"updated",action:e})})}};function ee(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:V(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}function te(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function ne(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==t,i=n?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function ie(e){return{onFetch:(t,n)=>{const i=t.options,o=t.fetchOptions?.meta?.fetchMore?.direction,r=t.state.data?.pages||[],s=t.state.data?.pageParams||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let n=!1;const c=U(t.options,t.fetchOptions),u=async(e,i,o)=>{if(n)return Promise.reject();if(null==i&&e.pages.length)return Promise.resolve(e);const r=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:i,direction:o?"backward":"forward",meta:t.options.meta};return void Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(t.signal.aborted?n=!0:t.signal.addEventListener("abort",()=>{n=!0}),t.signal)}),e})(),s=await c(r),{maxPages:a}=t.options,l=o?q:z;return{pages:l(e.pages,s,a),pageParams:l(e.pageParams,i,a)}};if(o&&r.length){const e="backward"===o,t={pages:r,pageParams:s},n=(e?re:oe)(i,t);a=await u(t,n,e)}else{const t=e??r.length;do{const e=0===l?s[0]??i.initialPageParam:oe(i,a);if(l>0&&null==e)break;a=await u(a,e),l++}while(l<t)}return a};t.fetchFn=t.options.persister?()=>t.options.persister?.(c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):c}}}function oe(e,{pages:t,pageParams:n}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,n[i],n):void 0}function re(e,{pages:t,pageParams:n}){return t.length>0?e.getPreviousPageParam?.(t[0],t,n[0],n):void 0}var se=class extends X{#u;#p;#g;#d;constructor(e){super(),this.#u=e.client,this.mutationId=e.mutationId,this.#g=e.mutationCache,this.#p=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#p.includes(e)||(this.#p.push(e),this.clearGcTimeout(),this.#g.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#p=this.#p.filter(t=>t!==e),this.scheduleGc(),this.#g.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#p.length||("pending"===this.state.status?this.scheduleGc():this.#g.remove(this))}continue(){return this.#d?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#f({type:"continue"})},n={client:this.#u,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#d=J({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#f({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#f({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#g.canRun(this)});const i="pending"===this.state.status,o=!this.#d.canStart();try{if(i)t();else{this.#f({type:"pending",variables:e,isPaused:o}),await(this.#g.config.onMutate?.(e,this,n));const t=await(this.options.onMutate?.(e,n));t!==this.state.context&&this.#f({type:"pending",context:t,variables:e,isPaused:o})}const r=await this.#d.start();return await(this.#g.config.onSuccess?.(r,e,this.state.context,this,n)),await(this.options.onSuccess?.(r,e,this.state.context,n)),await(this.#g.config.onSettled?.(r,null,this.state.variables,this.state.context,this,n)),await(this.options.onSettled?.(r,null,e,this.state.context,n)),this.#f({type:"success",data:r}),r}catch(r){try{throw await(this.#g.config.onError?.(r,e,this.state.context,this,n)),await(this.options.onError?.(r,e,this.state.context,n)),await(this.#g.config.onSettled?.(void 0,r,this.state.variables,this.state.context,this,n)),await(this.options.onSettled?.(void 0,r,e,this.state.context,n)),r}finally{this.#f({type:"error",error:r})}}finally{this.#g.runNext(this)}}#f(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),$.batch(()=>{this.#p.forEach(t=>{t.onMutationUpdate(e)}),this.#g.notify({mutation:this,type:"updated",action:e})})}};function ae(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var le=class extends g{constructor(e={}){super(),this.config=e,this.#y=new Set,this.#b=new Map,this.#v=0}#y;#b;#v;build(e,t,n){const i=new se({client:e,mutationCache:this,mutationId:++this.#v,options:e.defaultMutationOptions(t),state:n});return this.add(i),i}add(e){this.#y.add(e);const t=ce(e);if("string"==typeof t){const n=this.#b.get(t);n?n.push(e):this.#b.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#y.delete(e)){const t=ce(e);if("string"==typeof t){const n=this.#b.get(t);if(n)if(n.length>1){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}else n[0]===e&&this.#b.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=ce(e);if("string"==typeof t){const n=this.#b.get(t),i=n?.find(e=>"pending"===e.state.status);return!i||i===e}return!0}runNext(e){const t=ce(e);if("string"==typeof t){const n=this.#b.get(t)?.find(t=>t!==e&&t.state.isPaused);return n?.continue()??Promise.resolve()}return Promise.resolve()}clear(){$.batch(()=>{this.#y.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#y.clear(),this.#b.clear()})}getAll(){return Array.from(this.#y)}find(e){const t={exact:!0,...e};return this.getAll().find(e=>A(t,e))}findAll(e={}){return this.getAll().filter(t=>A(e,t))}notify(e){$.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return $.batch(()=>Promise.all(e.map(e=>e.continue().catch(w))))}};function ce(e){return e.options.scope?.id}var ue=class extends g{constructor(e={}){super(),this.config=e,this.#w=new Map}#w;build(e,t,n){const i=t.queryKey,o=t.queryHash??C(i,t);let r=this.get(o);return r||(r=new Z({client:e,queryKey:i,queryHash:o,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(r)),r}add(e){this.#w.has(e.queryHash)||(this.#w.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#w.get(e.queryHash);t&&(e.destroy(),t===e&&this.#w.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){$.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#w.get(e)}getAll(){return[...this.#w.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>T(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>T(e,t)):t}notify(e){$.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){$.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){$.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},de=o.createContext(void 0),he=e=>{const t=o.useContext(de);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},me=({client:t,children:n})=>(o.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(de.Provider,{value:t,children:n}));(new class{components;constructor(){this.components={Modal:i,Collapse:n,Dropdown:t}}getComponents(){return this.components}initializeGlobal(){"undefined"!=typeof window&&(window.bootstrap=this.components)}}).initializeGlobal();const fe=e=>{let t;const n=new Set,i=(e,i)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=i?i:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,r={setState:i,getState:o,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(i,o,r);return r},pe=e=>e;function ge(e,t){let n;try{n=e()}catch(i){return}return{getItem:e=>{var t;const i=e=>null===e?null:JSON.parse(e,void 0),o=null!=(t=n.getItem(e))?t:null;return o instanceof Promise?o.then(i):i(o)},setItem:(e,t)=>n.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>n.removeItem(e)}}const ye=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then:e=>ye(e)(n),catch(e){return this}}}catch(n){return{then(e){return this},catch:e=>ye(e)(n)}}},be={user:null,session:null,currentPatient:null,currentDepartment:null,filters:{search:"",stato:void 0,reparto:void 0,diagnosi:void 0,infetto:void 0,trasferimento:void 0,page:0,sortColumn:"data_ricovero",sortDirection:"desc"},ui:{loading:!1,theme:"light",sidebarOpen:!1}},ve=(e=>{const t=(e=>e?fe(e):fe)(e),n=e=>function(e,t=pe){const n=r.useSyncExternalStore(e.subscribe,r.useCallback(()=>t(e.getState()),[e,t]),r.useCallback(()=>t(e.getInitialState()),[e,t]));return r.useDebugValue(n),n}(t,e);return Object.assign(n,t),n})(((e,t)=>(n,i,o)=>{let r={storage:ge(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},s=!1;const a=new Set,l=new Set;let c=r.storage;if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...e)},i,o);const u=()=>{const e=r.partialize({...i()});return c.setItem(r.name,{state:e,version:r.version})},d=o.setState;o.setState=(e,t)=>(d(e,t),u());const h=e((...e)=>(n(...e),u()),i,o);let m;o.getInitialState=()=>h;const f=()=>{var e,t;if(!c)return;s=!1,a.forEach(e=>{var t;return e(null!=(t=i())?t:h)});const o=(null==(t=r.onRehydrateStorage)?void 0:t.call(r,null!=(e=i())?e:h))||void 0;return ye(c.getItem.bind(c))(r.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===r.version)return[!1,e.state];if(r.migrate){const t=r.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;const[o,s]=e;if(m=r.merge(s,null!=(t=i())?t:h),n(m,!0),o)return u()}).then(()=>{null==o?void 0:o(m,void 0),m=i(),s=!0,l.forEach(e=>e(m))}).catch(e=>{null==o?void 0:o(void 0,e)})};return o.persist={setOptions:e=>{r={...r,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c?void 0:c.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>f(),hasHydrated:()=>s,onHydrate:e=>(a.add(e),()=>{a.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},r.skipHydration||f(),m||h})((e,t)=>({...be,setState:(t,n)=>e({[t]:n}),setLoading:t=>e(e=>({ui:{...e.ui,loading:t}})),setTheme:t=>e(e=>({ui:{...e.ui,theme:t}})),toggleSidebar:()=>e(e=>({ui:{...e.ui,sidebarOpen:!e.ui.sidebarOpen}})),setUser:t=>e({user:t}),setSession:t=>e({session:t}),setFilters:t=>e(e=>({filters:{...e.filters,...t,page:0}})),setPage:t=>e(e=>({filters:{...e.filters,page:t}})),setSort:n=>{const{filters:i}=t(),o=i.sortColumn===n&&"desc"===i.sortDirection?"asc":"desc";e(e=>({filters:{...e.filters,sortColumn:n,sortDirection:o,page:0}}))},resetFilters:()=>e(e=>({...e,filters:be.filters}))}),{name:"app-storage",storage:ge(()=>localStorage),partialize:e=>({ui:{...e.ui,loading:!1,sidebarOpen:!1},filters:e.filters})})),we=()=>{const{user:e,session:t,setUser:n,setSession:i}=ve();return{user:e,session:t,isAuthenticated:!!t&&!!e,setUser:n,setSession:i}},Ee=()=>[ve(e=>e.ui.theme),ve(e=>e.setTheme)],Se=({isOpen:t,onToggle:n,routes:i})=>{const{user:o}=we(),r=o?.ruolo??null,a=i.filter(e=>((e,t)=>!e.permissions||0===e.permissions.length||!!t&&e.permissions.includes(t))(e,r));return e.jsxs("aside",{className:"app-sidebar bg-dark text-white d-flex flex-column "+(t?"open":"collapsed"),"aria-hidden":t?"false":"true",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between p-3 border-bottom border-dark",children:[e.jsx("span",{className:"fw-semibold text-uppercase small",children:"Navigazione"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light d-inline-flex align-items-center",onClick:n,"aria-label":"Close sidebar",children:e.jsx("span",{className:"material-icons","aria-hidden":"true",children:"close"})})]}),e.jsx("nav",{"aria-label":"Primary navigation",className:"flex-grow-1 overflow-auto",children:e.jsx("ul",{className:"nav flex-column py-2",children:a.map(t=>e.jsx("li",{className:"nav-item",children:e.jsxs(s,{to:t.path,className:({isActive:e})=>["nav-link text-white d-flex align-items-center gap-2 px-3 py-2",e?"active fw-semibold bg-primary-subtle text-dark rounded-1":""].filter(Boolean).join(" "),onClick:n,children:[t.icon&&e.jsx("span",{className:"material-icons","aria-hidden":"true",children:t.icon}),e.jsx("span",{children:t.label})]})},t.path))})})]})},_e="PatientTrack",xe="1.0.0",Te="warn";const Ae=new class{level;levels;constructor(){this.levels={error:0,warn:1,info:2,debug:3};const e=Te.toLowerCase();this.level=this.levels[e]??1}sanitizeArgs(e){const t=new Set(["password","token","auth","secret","nome","cognome","codice_fiscale","codice_rad","telefono","email","indirizzo","indirizzo_residenza","citta","cap","note","descrizione"]),n=e=>{if(null==e)return e;if("string"==typeof e)return e.length>200?e.slice(0,200)+"â€¦":e;if(e instanceof Error)return{name:e.name,message:e.message};if(Array.isArray(e))return e.map(n);if("object"==typeof e){const i={};for(const[o,r]of Object.entries(e))i[o]=t.has(o)?"[REDACTED]":n(r);return i}return e};return e.map(n)}log(...e){}warn(...e){}error(...e){const t=this.sanitizeArgs(e);console.error(...t)}info(...e){}debug(...e){}group(e){}groupEnd(){}table(e){}time(e){}timeEnd(e){}};let Ce=null;function ke(e){const t=e.startsWith("/")?e:`/${e}`;Ce?Ce(t):window.location.pathname=t}const Oe=[/password/i,/token/i,/secret/i,/api[_-]?key/i,/auth/i,/credential/i,/ssn/i,/social[_-]?security/i];function Ne(e){return Oe.some(t=>t.test(e))}function Ie(e,t="[REDACTED]"){const n={...e};for(const[i,o]of Object.entries(n))Ne(i)?n[i]=t:"object"!=typeof o||null===o||Array.isArray(o)||(n[i]=Ie(o));return n}const Re=m("https://aiguzywadjzyrwandgba.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFpZ3V6eXdhZGp6eXJ3YW5kZ2JhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyMDM1MzQsImV4cCI6MjA2Njc3OTUzNH0.pezVt3-xxkHBYK2V6ryHUtj_givF_TA9xwEzuK2essw",{auth:{flowType:"implicit",detectSessionInUrl:!0,persistSession:!0,autoRefreshToken:!0,storage:"undefined"!=typeof window?window.sessionStorage:window.localStorage,storageKey:"supabase.auth.token",debug:!1},global:{headers:{"X-Client-Info":"supabase-js-vite"}}});const Le=new class{readyPromise;resolveReady;constructor(){this.readyPromise=new Promise(e=>{this.resolveReady=e}),this.init()}async init(){await this.waitForViteReady(),await this.waitForSupabaseReady(),this.notifyReady()}async waitForViteReady(){return new Promise(e=>{"complete"===document.readyState?(Ae.log("Vite Ã¨ pronto"),e()):window.addEventListener("load",()=>{setTimeout(()=>{Ae.log("Vite Ã¨ pronto (dopo load)"),e()},100)},{once:!0})})}async waitForSupabaseReady(){return new Promise(async e=>{try{await Re.auth.getSession(),Ae.log("Supabase Ã¨ pronto"),e()}catch(t){Ae.error("Errore nell'inizializzazione Supabase:",t),this.clearCorruptedState(),setTimeout(async()=>{try{await Re.auth.getSession(),Ae.log("Supabase Ã¨ pronto (dopo retry)"),e()}catch(t){Ae.error("Errore nel retry Supabase:",t),e()}},500)}})}clearCorruptedState(){Ae.log("Pulisco stato corrotto...");["supabase.auth.token",""].filter(Boolean).forEach(e=>{localStorage.removeItem(e),sessionStorage.removeItem(e)}),document.cookie.split(";").forEach(e=>{const t=e.indexOf("="),n=(t>-1?e.substring(0,t):e).trim();(n.includes("supabase")||n.includes("sb-"))&&(document.cookie=`${n}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`)})}onReady(e){return e?(void this.readyPromise.then(e),void 0):this.readyPromise}notifyReady(){Ae.log("Middleware Vite-Supabase pronto"),this.resolveReady()}};var je;(e=>{function t(){return new URLSearchParams(window.location.hash.substring(1))}function n(){return t().has("access_token")||window.location.search.includes("code")}e.parseOAuthFragment=t,e.hasOAuthParams=function(){const e=t(),n=new URLSearchParams(window.location.search);return e.has("access_token")||e.has("refresh_token")||n.has("code")||e.has("error")},e.hasOAuthTokens=n,e.buildOAuthRedirectUrl=function(){return window.location.origin+window.location.pathname+window.location.hash},e.cleanupOAuthUrl=function(){if(!n())return;const e=t(),i=e.toString()?"#"+e.toString():"",o=window.location.pathname+("#"!==i?i:"");window.history.replaceState({},document.title,o),Ae.log("URL cleaned from OAuth tokens, new URL:",o)}})(je||(je={}));const Pe=new class{isInitialized=!1;authState="idle";errorState=null;constructor(){void this.init()}async init(){if(!this.isInitialized){await new Promise(e=>{Le.onReady(e)});try{je.hasOAuthParams()?(Ae.log("Rilevato redirect OAuth con parametri reali, gestisco la sessione..."),this.authState="authenticating",await this.handleOAuthCallback()):Ae.log("Nessun parametro OAuth rilevato, inizializzazione normale"),this.isInitialized=!0}catch(e){Ae.error("Errore nell'inizializzazione OAuth:",e),this.errorState=e,this.authState="error"}}}async handleOAuthCallback(){try{Ae.log("Gestisco callback OAuth...");if(new URLSearchParams(window.location.search).has("code")){Ae.log("Rilevato parametro code, eseguo exchangeCodeForSession...");const{error:e,data:t}=await Re.auth.exchangeCodeForSession(window.location.href);if(e){const t=e;if(404!==t?.status)throw Ae.error("Errore in exchangeCodeForSession:",e),this.clearCorruptedState(),e;Ae.warn("Codice OAuth giÃ  consumato (404). Continuo con la sessione esistente.")}else Ae.log("exchangeCodeForSession completato:",!!t?.session)}const{data:e,error:t}=await Re.auth.getSession();if(t)throw Ae.error("Errore nel callback OAuth:",t),this.clearCorruptedState(),t;const n=e.session;if(n){Ae.log("Sessione OAuth recuperata con successo"),this.authState="authenticated",this.cleanupOAuthUrl();const e=sessionStorage.getItem("redirectUrl");if(e){sessionStorage.removeItem("redirectUrl");ke((e.startsWith("#")?e.slice(1):e)||"/home")}else sessionStorage.removeItem("editPazienteId"),sessionStorage.removeItem("formData"),sessionStorage.removeItem("currentFilters"),void ke("/home")}return n}catch(e){throw Ae.error("Errore nella gestione del callback OAuth:",e),this.clearCorruptedState(),e}}clearCorruptedState(){Ae.log("Pulisco stato corrotto OAuth..."),Le.clearCorruptedState(),this.cleanupOAuthUrl(),this.authState="idle",this.errorState=null}cleanupOAuthUrl(){je.cleanupOAuthUrl()}async signInWithGoogle(){try{await Le.onReady(),"error"===this.authState&&(Ae.log("Stato di errore rilevato, pulisco..."),this.clearCorruptedState(),await new Promise(e=>setTimeout(e,100))),this.authState="authenticating";const e=je.buildOAuthRedirectUrl();Ae.log("Iniziando login OAuth con redirect:",e);const{data:t,error:n}=await Re.auth.signInWithOAuth({provider:"google",options:{redirectTo:e,queryParams:{}}});if(n)throw Ae.error("Errore nella chiamata OAuth:",n),this.authState="error",this.errorState=n,n;return Ae.log("Login OAuth iniziato con successo:",t),{success:!0,data:t}}catch(e){Ae.error("Errore completo nel login OAuth:",e);const t=e;401===t?.status&&(Ae.log("Errore 401 rilevato, pulisco stato corrotto..."),this.clearCorruptedState()),this.authState="error",this.errorState=t??e;return{success:!1,error:t?.message||e?.message||"Errore sconosciuto"}}}getAuthState(){return{state:this.authState,error:this.errorState,isInitialized:this.isInitialized}}},De={session:null,profile:null,isLoading:!0};function Me(e,t="editor"){const n=e.email?.split("@")[0]??e.user_metadata?.name??"utente";return{id:e.id,username:n,full_name:e.user_metadata?.full_name||e.user_metadata?.name||e.email||"Utente",role:t,email:e.email,fallback:!0}}async function ze(e){if(e?.user){const t=await async function(e){if(!e)return null;try{const{data:t,error:n,status:i}=await Re.from("profiles").select("username, full_name, role").eq("id",e.id).maybeSingle();if(n&&406!==i)throw n;const o=t??null;return o?{id:e.id,username:o.username??e.email?.split("@")[0]??"utente",full_name:o.full_name??e.email??"Utente",role:o.role??"editor",email:e.email}:null}catch(t){Ae.error("Errore nel recuperare il profilo utente:",t),Ae.warn("ðŸ”„ Uso profilo di fallback per utente:",e.email?.substring(0,3)+"***");try{const t=(await Re.rpc("get_user_role_safe",{user_uuid:e.id})).data||"editor";return Ae.info("âœ… Ruolo recuperato con funzione sicura:",t),Me(e,t)}catch(n){return Ae.error("âŒ Errore nel recupero ruolo sicuro, uso fallback minimo:",n),Me(e)}}}(e.user);De.session=e,t?De.profile=t:(Ae.warn("âš ï¸ Profilo non disponibile, uso fallback per utente:",e.user.email?.substring(0,3)+"***"),De.profile=Me(e.user)),De.profile?.fallback?Ae.info("âœ… Utente autenticato con profilo di fallback:",De.profile.username):Ae.info("âœ… Utente autenticato:",De.profile?.username||"sconosciuto")}else De.session=null,De.profile=null;try{window.dispatchEvent(new CustomEvent("auth:session-changed",{detail:{session:e}}))}catch{}window.dispatchEvent(new CustomEvent("auth-profile-loaded"))}async function qe(){return Pe.signInWithGoogle()}async function Fe(){const e=async(t=0)=>{try{const{error:e}=await Re.auth.signOut();if(e&&"Auth session missing!"!==e.message)throw e}catch(n){const i=n,o=403===i?.status||String(i?.message).includes("403");if(!("Auth session missing!"===i?.message||"AuthSessionMissingError"===i?.name)){if(o&&t<1)return Ae.warn(`Logout returned 403, retrying... (attempt ${t+1}/1)`),await new Promise(e=>setTimeout(e,1e3)),e(t+1);throw n}Ae.warn("Sessione giÃ  mancante durante logout, continuando...")}};try{De.session=null,De.profile=null;try{window.dispatchEvent(new CustomEvent("auth:session-changed",{detail:{session:null}}))}catch{}return window.dispatchEvent(new CustomEvent("auth-profile-loaded")),await e(),{success:!0,data:void 0}}catch(t){Ae.error("Errore durante il signOut:",t),De.session=null,De.profile=null;try{window.dispatchEvent(new CustomEvent("auth:session-changed",{detail:{session:null}}))}catch{}window.dispatchEvent(new CustomEvent("auth-profile-loaded"));return{success:!1,error:(t instanceof Error?t.message:String(t))??"Logout fallito"}}}function Ue(){!function(){Ge(localStorage.getItem("theme")||"light");const e=document.getElementById("theme-toggle"),t=document.getElementById("theme-icon");if(!e||!t)return;e.addEventListener("click",()=>{Ge("dark"===(document.documentElement.getAttribute("data-bs-theme")||"light")?"light":"dark")})}(),function(){const e=document.getElementById("mobile-theme-toggle"),t=document.getElementById("mobile-theme-icon");if(!e||!t)return;function n(){if(!t||!e)return;"dark"===(document.documentElement.getAttribute("data-bs-theme")||"light")?(t.textContent="light_mode",e.setAttribute("title","ModalitÃ  chiara")):(t.textContent="dark_mode",e.setAttribute("title","ModalitÃ  scura"))}e.addEventListener("click",e=>{e.preventDefault();Ge("dark"===(document.documentElement.getAttribute("data-bs-theme")||"light")?"light":"dark")});new MutationObserver(n).observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]}),n()}()}function Ge(e){document.documentElement.setAttribute("data-bs-theme",e),localStorage.setItem("theme",e);const t=document.getElementById("theme-icon"),n=document.getElementById("theme-toggle");t&&n&&("dark"===e?(t.textContent="light_mode",n.setAttribute("title","ModalitÃ  chiara")):(t.textContent="dark_mode",n.setAttribute("title","ModalitÃ  scura")));const i=new CustomEvent("theme-change",{detail:{theme:e}});document.dispatchEvent(i),window.dispatchEvent(i)}function Be(){return document.documentElement.getAttribute("data-bs-theme")||"light"}const He=({onNavigate:t})=>{const n=a(),{session:i,isAuthenticated:r}=we(),{setCurrentRoute:s}=(()=>{const{ui:e,setLoading:t,toggleSidebar:n,setTheme:i}=ve();return{uiState:e,setLoading:t,toggleSidebar:n,setTheme:i,currentRoute:ve(e=>e.ui.currentRoute),setCurrentRoute:e=>{ve.setState(t=>({ui:{...t.ui,currentRoute:e}}))}}})(),[l,c]=Ee(),[u,d]=o.useState(l),h=o.useRef(null);o.useEffect(()=>{const e=h.current;if(e)return e.dataset.reactControlled="true",document.body.classList.remove("mobile-filters-open"),document.body.style.removeProperty("overflow"),()=>{delete e.dataset.reactControlled}},[]),o.useEffect(()=>{if("undefined"==typeof document)return;const e=Be();e!==l&&c(e)},[l,c]),o.useEffect(()=>{d(l)},[l]);const m=o.useCallback(()=>{const e="dark"===u?"light":"dark";c(e),Ge(e),d(e)},[u,c]),f=o.useCallback(()=>{const e="/home";if(s(e),t)return t(e),void 0;n(e)},[n,t,s]),p=o.useCallback(async()=>{if(r&&i)try{await Fe(),n("/login")}catch(e){Ae.error("MobileNav: signOut failed",e)}else try{const e=await qe();e.success||Ae.error("MobileNav: Google login failed",e.error)}catch(e){Ae.error("MobileNav: Failed to sign in with Google",e)}},[r,i,n]),g="dark"===u?"light_mode":"dark_mode",y="dark"===u?"ModalitÃ  chiara":"ModalitÃ  scura",b=Boolean(r&&i),v=b?"logout":"login",w=b?"Esci":"Accedi";return e.jsx("nav",{ref:h,className:"mobile-navbar d-lg-none","aria-label":"Navigazione mobile",children:e.jsxs("div",{className:"mobile-navbar-container",children:[e.jsx("button",{id:"mobile-theme-toggle",type:"button",className:"mobile-nav-action","aria-label":y,title:y,onClick:m,children:e.jsx("span",{className:"material-icons",id:"mobile-theme-icon",children:g})}),e.jsx("button",{id:"mobile-home-link",type:"button",className:"mobile-nav-action"+(b?" navbar-home-logged":""),"aria-label":"Vai alla home",title:"Home",onClick:f,children:e.jsx("span",{className:"material-icons",children:"home"})}),e.jsx("button",{id:"mobile-auth-container",type:"button",className:"mobile-nav-action","aria-label":w,title:w,onClick:p,children:e.jsx("span",{className:"material-icons",children:v})})]})})},We=[{path:"/home",label:"Home",icon:"home",permissions:["admin","editor","viewer"]},{path:"/inserimento",label:"Inserimento",icon:"note_add",permissions:["admin","editor"]},{path:"/list",label:"Elenco pazienti",icon:"list",permissions:["admin","editor","viewer"]},{path:"/dimissione",label:"Dimissioni",icon:"logout",permissions:["admin","editor"]},{path:"/unified-charts",label:"Grafici",icon:"query_stats",permissions:["admin","editor","viewer"]},{path:"/diagnosi",label:"Diagnosi",icon:"healing",permissions:["admin"]},{path:"/eventi-clinici",label:"Eventi clinici",icon:"medical_services",permissions:["admin","editor","viewer"]}];function $e(){const[t,n]=Ee(),[i,r]=o.useState(t);o.useEffect(()=>{const e=Be();e!==t&&n(e)},[t,n]),o.useEffect(()=>{r(t)},[t]);const s=o.useCallback(()=>{const e="dark"===i?"light":"dark";n(e),Ge(e),r(e)},[i,n]),a="dark"===i?"Tema chiaro":"Tema scuro";return e.jsxs("button",{type:"button",className:"btn btn-outline-secondary d-flex align-items-center gap-1",onClick:s,"aria-label":a,title:a,children:[e.jsx("span",{className:"material-icons","aria-hidden":"true",children:"dark"===i?"light_mode":"dark_mode"}),e.jsx("span",{className:"visually-hidden",children:a})]})}function Qe(){const{isAuthenticated:t,session:n}=we(),i=a(),r=o.useCallback(async()=>{if(t&&n)try{await Fe(),i("/login")}catch(e){Ae.error("Logout failed",e)}else try{const e=await qe();e.success||Ae.error("MainLayout: Google login failed",e.error)}catch(e){Ae.error("MainLayout: Failed to sign in with Google",e)}},[t,n,i]),s=t?"Esci":"Accedi";return e.jsxs("button",{type:"button",className:"btn btn-outline-secondary d-flex align-items-center gap-1",onClick:r,children:[e.jsx("span",{className:"material-icons","aria-hidden":"true",children:t?"logout":"login"}),e.jsx("span",{children:s})]})}function Ke({routes:t,theme:n}){const{user:i}=we(),r=a(),l=o.useMemo(()=>i?i.ruolo??i.role??null:null,[i]),c=o.useMemo(()=>t.filter(e=>((e,t)=>!e.permissions||0===e.permissions.length||!!t&&e.permissions.includes(t))(e,l)),[t,l]),u=o.useCallback(e=>{r(e)},[r]),d="dark"===n?"text-secondary":"text-dark";return e.jsx("ul",{className:"nav nav-pills gap-1 flex-grow-1",children:c.map(t=>e.jsx("li",{className:"nav-item",children:e.jsxs(s,{to:t.path,className:({isActive:e})=>["nav-link d-flex align-items-center gap-1 px-3 py-1",e?"active fw-600":d].filter(Boolean).join(" "),onClick:e=>{e.preventDefault(),u(t.path)},children:[t.icon&&e.jsx("span",{className:"material-icons","aria-hidden":"true",children:t.icon}),e.jsx("span",{children:t.label})]})},t.path))})}function Ve(){const{user:t,isAuthenticated:n}=we();if(!n||!t)return null;const i=t.ruolo??t.role??"caricamento...";return e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs("span",{className:"navbar-text text-secondary me-1",title:t.email||void 0,style:{fontSize:"0.9em"},children:[e.jsx("i",{className:"material-icons me-1",style:{fontSize:"1em",verticalAlign:"text-bottom"},children:"account_circle"}),t.email?.split("@")[0]||""]}),e.jsx("span",{className:"badge bg-info text-uppercase",style:{fontSize:"0.7em",padding:"0.3em 0.5em"},title:`Ruolo: ${i}`,children:i})]})}const Ye=({children:t,sidebar:n=!0,header:i=!0})=>{const[r,c]=[ve(e=>e.ui.sidebarOpen),ve(e=>e.toggleSidebar)],u=a(),d=l(),[h]=Ee(),m="/login"===d.pathname,f=i&&!m&&!("/home"===d.pathname),[p,g]=o.useState(()=>"undefined"!=typeof window&&window.matchMedia("(max-width: 767px)").matches);return o.useEffect(()=>{if("undefined"==typeof window)return;const e=window.matchMedia("(max-width: 767px)"),t=e=>g(e.matches);return g(e.matches),e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}},[]),o.useEffect(()=>{if("undefined"!=typeof document)return document.body.classList.remove("mobile-filters-open"),document.body.style.removeProperty("overflow"),p?document.body.dataset.reactMobileNav="true":delete document.body.dataset.reactMobileNav,()=>{delete document.body.dataset.reactMobileNav,document.body.classList.remove("mobile-filters-open"),document.body.style.removeProperty("overflow")}},[p]),e.jsxs("div",{className:"app-shell d-flex min-vh-100",children:[n&&!m&&e.jsx(Se,{isOpen:r,onToggle:c,routes:We}),e.jsxs("div",{className:"flex-grow-1 d-flex flex-column",style:{minHeight:0},children:[e.jsx("a",{className:"visually-hidden-focusable",href:"#main-content",children:"Salta al contenuto"}),f&&!p&&e.jsxs("header",{role:"banner",className:`navbar ${"dark"===h?"navbar-dark bg-dark":"navbar-light bg-light"} border-bottom d-flex flex-wrap align-items-center px-3 py-2 gap-3`,children:[e.jsxs("div",{className:"d-flex align-items-center gap-3 w-100",children:[n&&e.jsx("button",{type:"button",className:"btn btn-outline-primary d-inline-flex align-items-center d-lg-none",onClick:c,"aria-label":"Toggle sidebar",children:e.jsx("span",{className:"material-icons","aria-hidden":"true",children:"menu"})}),e.jsxs(s,{to:"/home",className:"navbar-brand mb-0 h5 text-decoration-none d-flex align-items-center flex-shrink-0",children:[e.jsx("img",{src:"/favicon.png",alt:"PatientTrack Logo",width:"48",height:"40",className:"d-inline-block align-text-top me-3 navbar-logo"}),e.jsx("span",{className:"d-none d-sm-inline",children:"PatientTrack"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2 ms-auto",children:[e.jsx($e,{}),e.jsx(Qe,{})]}),e.jsx(Ve,{})]}),e.jsx("nav",{className:"w-100 d-flex align-items-center gap-3",children:e.jsx(Ke,{routes:We,theme:h})})]}),f&&p&&e.jsx(He,{onNavigate:e=>u(e)}),e.jsx("main",{id:"main-content",role:"main",className:"flex-grow-1 p-3",style:p&&f?{paddingTop:"5.5rem",overflowY:"auto",WebkitOverflowScrolling:"touch",minHeight:0,height:"100%"}:{minHeight:0},children:t})]})]})};const Je=({children:t,allowedRoles:n=[],requireAuth:i=!0})=>{const{user:o,isAuthenticated:r}=we(),s=l(),a=function(){if("undefined"!=typeof window)return window.currentUser||null;return null}(),u=a&&(!(!(d=a.session)||"object"!=typeof d)&&"string"==typeof d.access_token&&"number"==typeof d.expires_at&&void 0!==d.user);var d;if(i&&!r&&!u)return e.jsx(c,{to:"/login",state:{from:s},replace:!0});let h=null;return o?h=o.role??null:a&&function(e){return!(!e||"object"!=typeof e)&&("string"==typeof e.id&&"string"==typeof e.email&&"string"==typeof e.role)}(a.profile)&&(h=a.profile.role??null),n.length>0&&h&&!n.includes(h)?e.jsx(c,{to:"/home",replace:!0}):e.jsx(e.Fragment,{children:t})};function Xe(){return e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Caricamento in corso..."})})})}const Ze=o.lazy(()=>p(()=>import("./index-qxKMwVtJ.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),et=o.lazy(()=>p(()=>import("./LoginPage-v1z-YCd-.js"),__vite__mapDeps([7,1,2,5,8]))),tt=o.lazy(()=>p(()=>import("./PatientFormPage-DmfkuKq1.js"),__vite__mapDeps([9,1,2,10,11,12,13,4,14,15,3,16,17,18,19,20,5,21]))),nt=o.lazy(()=>p(()=>import("./PatientListPage-BFTg1o-K.js"),__vite__mapDeps([22,1,2,23,24,16,10,20,3,4,17,11,12,25,5]))),it=o.lazy(()=>p(()=>import("./DischargePage-v_iMbvup.js"),__vite__mapDeps([26,1,2,23,24,10,11,12,13,4,14,3,5]))),ot=o.lazy(()=>p(()=>import("./index-CeQ8WJMT.js"),__vite__mapDeps([27,1,2,11,12,13,4,14,28,23,17,16,5,29])).then(e=>({default:e.ChartsPage}))),rt=o.lazy(()=>p(()=>import("./DiagnosiPage-DqZgSn43.js"),__vite__mapDeps([30,1,2,16,5]))),st=o.lazy(()=>p(()=>import("./EventsPage-NK1u2TxF.js"),__vite__mapDeps([31,1,2,23,24,10,11,12,13,4,14,32,3,18,19,16,33,15,25,20,5,34]))),at=o.lazy(()=>p(()=>import("./EventWizardPage-RsunWXUk.js"),__vite__mapDeps([35,1,2,32,3,4,13,12,14,18,19,23,16,33,20,5]))),lt=[{path:"/",element:e.jsx(c,{to:"/home",replace:!0})},{path:"/home",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin","editor","viewer"],children:e.jsx(Ze,{})})})},{path:"/login",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(et,{})})},{path:"/inserimento",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin","editor"],children:e.jsx(tt,{})})})},{path:"/list",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin","editor","viewer"],children:e.jsx(nt,{})})})},{path:"/dimissione",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin","editor"],children:e.jsx(it,{})})})},{path:"/unified-charts",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin","editor","viewer"],children:e.jsx(ot,{})})})},{path:"/diagnosi",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin"],children:e.jsx(rt,{})})})},{path:"/eventi-clinici",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin","editor","viewer"],children:e.jsx(st,{})})})},{path:"/eventi-clinici/nuovo",element:e.jsx(o.Suspense,{fallback:e.jsx(Xe,{}),children:e.jsx(Je,{allowedRoles:["admin","editor"],children:e.jsx(at,{})})})},{path:"*",element:e.jsx(c,{to:"/home",replace:!0})}],ct=o.createContext(void 0);function ut({children:t}){const[n,i]=o.useState({session:De.session,profile:De.profile,isLoading:De.isLoading});return o.useEffect(()=>{const e=()=>{i({session:De.session,profile:De.profile,isLoading:De.isLoading})};e();const t=setInterval(e,2e3);return()=>{clearInterval(t)}},[]),e.jsx(ct.Provider,{value:n,children:t})}function dt(){return e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}function ht({error:t,resetError:n}){return e.jsx("div",{className:"container mt-5",children:e.jsxs("div",{className:"alert alert-danger",role:"alert",children:[e.jsx("h4",{className:"alert-heading",children:"Si Ã¨ verificato un errore"}),e.jsx("p",{children:t.message}),e.jsx("hr",{}),e.jsx("button",{className:"btn btn-primary",onClick:n,children:"Riprova"})]})})}class mt extends r.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){Ae.error("React Error Boundary caught error:",{error:e.message,stack:e.stack,componentStack:t.componentStack})}resetError=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError&&this.state.error?e.jsx(ht,{error:this.state.error,resetError:this.resetError}):this.props.children}}function ft(){const e=a();o.useEffect(()=>{!function(e){Ce=e}(e)},[e]);return d(lt)}function pt(){return o.useEffect(()=>(Ae.log("ðŸš€ React App mounted"),()=>{Ae.log("ðŸ‘‹ React App unmounted")}),[]),o.useEffect(()=>{const e=()=>{const{setUser:e,setSession:t}=ve.getState();if(De.profile&&De.session){const n={id:De.profile.id,email:De.profile.email||"",role:De.profile.role,full_name:De.profile.full_name,username:De.profile.username},i={access_token:De.session.access_token,refresh_token:De.session.refresh_token,expires_at:De.session.expires_at||0,expires_in:De.session.expires_in,token_type:De.session.token_type,user:n};e(n),t(i),Ae.log("âœ… Zustand store sincronizzato con currentUser")}else e(null),t(null)};return e(),window.addEventListener("auth:session-changed",e),window.addEventListener("auth-profile-loaded",e),()=>{window.removeEventListener("auth:session-changed",e),window.removeEventListener("auth-profile-loaded",e)}},[]),e.jsx(mt,{children:e.jsx(ut,{children:e.jsx(u,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(o.Suspense,{fallback:e.jsx(dt,{}),children:e.jsx(Ye,{children:e.jsx(ft,{})})})})})})}function gt(e,t=150,n={}){const{leading:i=!1,trailing:o=!0}=n;let r=null,s=null,a=null,l=!1;function c(){r=null,o&&s&&(e.apply(a,s),s=null,a=null,l=!1)}const u=function(...n){s=n,a=this,r?(clearTimeout(r),r=setTimeout(c,t)):(i&&!l&&(e.apply(a,s),l=!0,s=null,a=null),r=setTimeout(c,t))};return u.cancel=()=>{r&&(clearTimeout(r),r=null),s=null,a=null,l=!1},u.flush=()=>{r&&(clearTimeout(r),r=null),s&&(e.apply(a,s),s=null,a=null,l=!1)},u.pending=()=>null!==r,u}function yt(e,t=100){let n=!1;const i=function(...i){n||(e.apply(this,i),n=!0,setTimeout(()=>{n=!1},t))};return i.cancel=()=>{n=!1},i.flush=()=>{},i}let bt=window.innerWidth<=767;const vt=e=>Boolean(e&&"true"===e.dataset.reactControlled);function wt(){const e=document.querySelector(".navbar"),t=document.querySelector(".mobile-navbar"),n=window.innerWidth<=767;if(!e||!t)return bt=n,void 0;if(vt(t))return bt=n,void 0;if(n===bt)return e.classList.toggle("d-none",n),t.classList.toggle("d-none",!n),void 0;bt=n,Ae.log("Mode changed to: "+(n?"mobile":"desktop"));const i=new CustomEvent("mode:change",{detail:{isMobile:n}});window.dispatchEvent(i),e.classList.toggle("d-none",n),t.classList.toggle("d-none",!n),n&&Et()}function Et(){const e=document.getElementById("mobile-auth-container"),t=document.getElementById("mobile-home-link");if(!e||!t)return;if(vt(e.closest(".mobile-navbar")))return;if(De.session){const n=document.createElement("span");n.className="material-icons",n.title="Logout",n.textContent="logout",e.replaceChildren(n),e.onclick=async e=>{e.preventDefault(),await Fe()},t.classList.add("navbar-home-logged")}else{const n=document.createElement("span");n.className="material-icons",n.title="Login",n.textContent="login",e.replaceChildren(n),e.onclick=e=>{e.preventDefault();const t=document.getElementById("login-modal-trigger");t&&t.click()},t.classList.remove("navbar-home-logged")}}function St(){void window.addEventListener("error",e=>{if(["A listener indicated an asynchronous response by returning true","Extension context invalidated","Could not establish connection","chrome-extension://","moz-extension://"].some(t=>e.message&&e.message.includes(t)))return Ae.debug("Browser extension error ignored:",e.message),e.preventDefault(),!1;Ae.error("Application error:",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error})}),window.addEventListener("unhandledrejection",e=>{const t=e.reason?.message||e.reason?.toString()||"";if(["A listener indicated an asynchronous response by returning true","message channel closed before a response was received","Extension context invalidated","Could not establish connection"].some(e=>t.includes(e)))return Ae.debug("Browser extension promise rejection ignored:",t),e.preventDefault(),void 0;Ae.error("Unhandled promise rejection:",e.reason)}),window.appLogger={info:(e,t=null)=>{Ae.log(`[APP] ${e}`,t||"")},warn:(e,t=null)=>{Ae.warn(`[APP WARNING] ${e}`,t||"")},error:(e,t=null)=>{Ae.error("[APP ERROR]",e,t||"")},debug:(e,t=null)=>{"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname||Ae.log(`[APP DEBUG] ${e}`,t||"")},log:(e,t=null)=>{Ae.log(`[APP LOG] ${e}`,t||"")}}}let _t=null;function xt(){if(!_t)throw new Error("Notification system not initialized. Make sure NotificationProvider is mounted in your app root.");return _t}function Tt(e){return"number"==typeof e?{duration:e}:e}function At(e,t){return xt().success(e,Tt(t))}function Ct(e,t){return xt().error(e,Tt(t))}function kt(e,t){return xt().warning(e,Tt(t))}const Ot={success:4e3,error:0,warning:6e3,info:5e3};function Nt(e,t){switch(t.type){case"ADD_NOTIFICATION":{const n=[t.payload,...e.notifications];return n.length>e.settings.maxNotifications&&n.splice(e.settings.maxNotifications),n.sort((e,t)=>e.priority!==t.priority?t.priority-e.priority:t.createdAt-e.createdAt),{...e,notifications:n}}case"REMOVE_NOTIFICATION":return{...e,notifications:e.notifications.filter(e=>e.id!==t.payload)};case"CLEAR_ALL":return{...e,notifications:[]};case"CLEAR_BY_TYPE":return{...e,notifications:e.notifications.filter(e=>e.type!==t.payload)};default:return e}}const It=o.createContext(void 0);function Rt({children:t,defaultPosition:n="top-right",defaultDuration:i=5e3,maxNotifications:r=5}){const[s,a]=o.useReducer(Nt,{notifications:[],settings:{defaultPosition:n,defaultDuration:i,maxNotifications:r}}),l=o.useRef(new Map);o.useEffect(()=>()=>{l.current.forEach(e=>clearTimeout(e)),l.current.clear()},[]);const c=o.useCallback((e,t)=>{if(t<=0)return;const n=l.current.get(e);n&&clearTimeout(n);const i=setTimeout(()=>{a({type:"REMOVE_NOTIFICATION",payload:e}),l.current.delete(e)},t);l.current.set(e,i)},[]),u=o.useCallback(()=>`notification-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,[]),d=o.useCallback((e,t,n={})=>{const i=n.id||u(),o={id:i,type:e,message:t,title:n.title||"",duration:void 0!==n.duration?n.duration:Ot[e],position:n.position||s.settings.defaultPosition,closable:!1!==n.closable,progressBar:!1!==n.progressBar,persistent:n.persistent||!1,priority:n.priority||0,actions:n.actions||[],icon:n.icon||"",className:n.className||"",createdAt:Date.now(),onClose:n.onClose};return a({type:"ADD_NOTIFICATION",payload:o}),!o.persistent&&o.duration>0&&c(i,o.duration),i},[s.settings.defaultPosition,u,c]),h=o.useCallback((e,t)=>d("success",e,t),[d]),m=o.useCallback((e,t)=>d("error",e,t),[d]),f=o.useCallback((e,t)=>d("warning",e,t),[d]),p=o.useCallback((e,t)=>d("info",e,t),[d]),g=o.useCallback(e=>{const t=s.notifications.find(t=>t.id===e);t?.onClose&&t.onClose();const n=l.current.get(e);n&&(clearTimeout(n),l.current.delete(e)),a({type:"REMOVE_NOTIFICATION",payload:e})},[s.notifications]),y=o.useCallback(()=>{s.notifications.forEach(e=>{e.onClose&&e.onClose()}),l.current.forEach(e=>clearTimeout(e)),l.current.clear(),a({type:"CLEAR_ALL"})},[s.notifications]),b=o.useCallback(e=>{s.notifications.filter(t=>t.type===e).forEach(e=>{e.onClose&&e.onClose();const t=l.current.get(e.id);t&&(clearTimeout(t),l.current.delete(e.id))}),a({type:"CLEAR_BY_TYPE",payload:e})},[s.notifications]),v={...s,show:d,success:h,error:m,warning:f,info:p,remove:g,clear:y,clearByType:b};return o.useEffect(()=>{void(_t={success:h,error:m,warning:f,info:p,remove:g,clear:y,clearByType:b})},[h,m,f,p,g,y,b]),e.jsx(It.Provider,{value:v,children:t})}function Lt(){const e=o.useContext(It);if(!e)throw new Error("useNotificationContext must be used within NotificationProvider");return e}const jt={notificationContainer:"_notificationContainer_1frkq_31",containerTopLeft:"_containerTopLeft_1frkq_50",containerTopCenter:"_containerTopCenter_1frkq_55",containerTopRight:"_containerTopRight_1frkq_61",containerBottomLeft:"_containerBottomLeft_1frkq_66",containerBottomCenter:"_containerBottomCenter_1frkq_72",containerBottomRight:"_containerBottomRight_1frkq_79",notification:"_notification_1frkq_31",notificationSuccess:"_notificationSuccess_1frkq_98",notificationError:"_notificationError_1frkq_102",notificationWarning:"_notificationWarning_1frkq_106",notificationInfo:"_notificationInfo_1frkq_110",notificationEnter:"_notificationEnter_1frkq_115",slideIn:"_slideIn_1frkq_1",notificationExit:"_notificationExit_1frkq_119",slideOut:"_slideOut_1frkq_1",notificationIcon:"_notificationIcon_1frkq_143","material-icons":"_material-icons_1frkq_151",notificationContent:"_notificationContent_1frkq_155",notificationTitle:"_notificationTitle_1frkq_160",notificationMessage:"_notificationMessage_1frkq_166",notificationClose:"_notificationClose_1frkq_172",notificationActions:"_notificationActions_1frkq_198",notificationAction:"_notificationAction_1frkq_198",notificationActionPrimary:"_notificationActionPrimary_1frkq_223",notificationActionSecondary:"_notificationActionSecondary_1frkq_231",notificationActionDanger:"_notificationActionDanger_1frkq_240",notificationProgress:"_notificationProgress_1frkq_248",notificationProgressBar:"_notificationProgressBar_1frkq_259",notificationProgressBarSuccess:"_notificationProgressBarSuccess_1frkq_266",notificationProgressBarError:"_notificationProgressBarError_1frkq_270",notificationProgressBarWarning:"_notificationProgressBarWarning_1frkq_274",notificationProgressBarInfo:"_notificationProgressBarInfo_1frkq_278"};function Pt({actions:t,onActionClick:n}){return e.jsx("div",{className:jt.notificationActions,children:t.map((t,i)=>e.jsx("button",{type:"button",className:`${jt.notificationAction} ${t.variant?jt[`notificationAction${t.variant.charAt(0).toUpperCase()+t.variant.slice(1)}`]:""}`,onClick:()=>(e=>{e.onClick(),n?.()})(t),children:t.label},i))})}function Dt({duration:t,type:n,onComplete:i,paused:r=!1}){const[s,a]=o.useState(100),[l,c]=o.useState(r),u=o.useRef(Date.now()),d=o.useRef(t),h=o.useRef(null);o.useEffect(()=>{c(r)},[r]),o.useEffect(()=>{if(l)return h.current&&(cancelAnimationFrame(h.current),h.current=null),void 0;u.current=Date.now();const e=()=>{const n=Date.now();d.current=Math.max(0,d.current-(n-u.current));if(a(d.current/t*100),d.current<=0)return i?.(),void 0;u.current=n,h.current=requestAnimationFrame(e)};return h.current=requestAnimationFrame(e),()=>{h.current&&cancelAnimationFrame(h.current)}},[t,l,i]);return e.jsx("div",{className:jt.notificationProgress,role:"progressbar","aria-valuenow":Math.round(s),"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Time remaining before auto-close",onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:e.jsx("div",{className:`${jt.notificationProgressBar} ${jt[`notificationProgressBar${n.charAt(0).toUpperCase()+n.slice(1)}`]}`,style:{transform:`scaleX(${s/100})`,transition:l?"none":"transform 100ms linear"}})})}function Mt({notification:t}){const{remove:n}=Lt(),[i,r]=o.useState(!1),s=()=>{r(!0),setTimeout(()=>{n(t.id)},300)},a=[jt.notification,jt[`notification${t.type.charAt(0).toUpperCase()+t.type.slice(1)}`],t.className,i?jt.notificationExit:jt.notificationEnter].filter(Boolean).join(" ");return e.jsxs("div",{className:a,role:"error"===t.type||"warning"===t.type?"alert":"status","aria-live":"error"===t.type?"assertive":"polite","aria-atomic":"true",children:[e.jsx("div",{className:jt.notificationIcon,children:e.jsx("span",{className:"material-icons",children:(()=>{if(t.icon)return t.icon;return{success:"check_circle",error:"error",warning:"warning",info:"info"}[t.type]})()})}),e.jsxs("div",{className:jt.notificationContent,children:[t.title&&e.jsx("div",{className:jt.notificationTitle,children:t.title}),e.jsx("div",{className:jt.notificationMessage,children:t.message}),t.actions&&t.actions.length>0&&e.jsx(Pt,{actions:t.actions,onActionClick:s})]}),t.closable&&e.jsx("button",{type:"button",className:jt.notificationClose,onClick:s,"aria-label":"Close notification",title:"Close",children:e.jsx("span",{className:"material-icons",children:"close"})}),t.progressBar&&!t.persistent&&t.duration>0&&e.jsx(Dt,{duration:t.duration,type:t.type,onComplete:s})]})}function zt(){const{notifications:t}=Lt(),n=o.useMemo(()=>{const e={"top-left":[],"top-center":[],"top-right":[],"bottom-left":[],"bottom-center":[],"bottom-right":[]};return t.forEach(t=>{e[t.position].push(t)}),e},[t]),i=e=>({"top-left":jt.containerTopLeft,"top-center":jt.containerTopCenter,"top-right":jt.containerTopRight,"bottom-left":jt.containerBottomLeft,"bottom-center":jt.containerBottomCenter,"bottom-right":jt.containerBottomRight}[e]);return e.jsx(e.Fragment,{children:Object.entries(n).map(([t,n])=>n.length>0&&e.jsx("div",{className:`${jt.notificationContainer} ${i(t)}`,role:"region","aria-label":`Notifications (${t.replace("-"," ")})`,"aria-live":"polite","aria-atomic":"false",children:n.map(t=>e.jsx(Mt,{notification:t},t.id))},t))})}const{entries:qt,setPrototypeOf:Ft,isFrozen:Ut,getPrototypeOf:Gt,getOwnPropertyDescriptor:Bt}=Object;let{freeze:Ht,seal:Wt,create:$t}=Object,{apply:Qt,construct:Kt}="undefined"!=typeof Reflect&&Reflect;Ht||(Ht=function(e){return e}),Wt||(Wt=function(e){return e}),Qt||(Qt=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return e.apply(t,i)}),Kt||(Kt=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new e(...n)});const Vt=dn(Array.prototype.forEach),Yt=dn(Array.prototype.lastIndexOf),Jt=dn(Array.prototype.pop),Xt=dn(Array.prototype.push),Zt=dn(Array.prototype.splice),en=dn(String.prototype.toLowerCase),tn=dn(String.prototype.toString),nn=dn(String.prototype.match),on=dn(String.prototype.replace),rn=dn(String.prototype.indexOf),sn=dn(String.prototype.trim),an=dn(Object.prototype.hasOwnProperty),ln=dn(RegExp.prototype.test),cn=(un=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Kt(un,t)});var un;function dn(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return Qt(e,t,i)}}function hn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:en;Ft&&Ft(e,null);let i=t.length;for(;i--;){let o=t[i];if("string"==typeof o){const e=n(o);e!==o&&(Ut(t)||(t[i]=e),o=e)}e[o]=!0}return e}function mn(e){for(let t=0;t<e.length;t++){an(e,t)||(e[t]=null)}return e}function fn(e){const t=$t(null);for(const[n,i]of qt(e)){an(e,n)&&(t[n]=Array.isArray(i)?mn(i):i&&"object"==typeof i&&i.constructor===Object?fn(i):i)}return t}function pn(e,t){for(;null!==e;){const n=Bt(e,t);if(n){if(n.get)return dn(n.get);if("function"==typeof n.value)return dn(n.value)}e=Gt(e)}return function(){return null}}const gn=Ht(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),yn=Ht(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),bn=Ht(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),vn=Ht(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),wn=Ht(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),En=Ht(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Sn=Ht(["#text"]),_n=Ht(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),xn=Ht(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Tn=Ht(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),An=Ht(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Cn=Wt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),kn=Wt(/<%[\w\W]*|[\w\W]*%>/gm),On=Wt(/\$\{[\w\W]*/gm),Nn=Wt(/^data-[\-\w.\u00B7-\uFFFF]+$/),In=Wt(/^aria-[\-\w]+$/),Rn=Wt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ln=Wt(/^(?:\w+script|data):/i),jn=Wt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pn=Wt(/^html$/i),Dn=Wt(/^[a-z][.\w]*(-[.\w]+)+$/i);var Mn=Object.freeze({__proto__:null,ARIA_ATTR:In,ATTR_WHITESPACE:jn,CUSTOM_ELEMENT:Dn,DATA_ATTR:Nn,DOCTYPE_NAME:Pn,ERB_EXPR:kn,IS_ALLOWED_URI:Rn,IS_SCRIPT_OR_DATA:Ln,MUSTACHE_EXPR:Cn,TMPLIT_EXPR:On});const zn=1,qn=3,Fn=7,Un=8,Gn=9;var Bn=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window;const n=t=>e(t);if(n.version="3.3.0",n.removed=[],!t||!t.document||t.document.nodeType!==Gn||!t.Element)return n.isSupported=!1,n;let{document:i}=t;const o=i,r=o.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:l,Element:c,NodeFilter:u,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:m,trustedTypes:f}=t,p=c.prototype,g=pn(p,"cloneNode"),y=pn(p,"remove"),b=pn(p,"nextSibling"),v=pn(p,"childNodes"),w=pn(p,"parentNode");if("function"==typeof a){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let E,S="";const{implementation:_,createNodeIterator:x,createDocumentFragment:T,getElementsByTagName:A}=i,{importNode:C}=o;let k={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof qt&&"function"==typeof w&&_&&void 0!==_.createHTMLDocument;const{MUSTACHE_EXPR:O,ERB_EXPR:N,TMPLIT_EXPR:I,DATA_ATTR:R,ARIA_ATTR:L,IS_SCRIPT_OR_DATA:j,ATTR_WHITESPACE:P,CUSTOM_ELEMENT:D}=Mn;let{IS_ALLOWED_URI:M}=Mn,z=null;const q=hn({},[...gn,...yn,...bn,...wn,...Sn]);let F=null;const U=hn({},[..._n,...xn,...Tn,...An]);let G=Object.seal($t(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),B=null,H=null;const W=Object.seal($t(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let $=!0,Q=!0,K=!1,V=!0,Y=!1,J=!0,X=!1,Z=!1,ee=!1,te=!1,ne=!1,ie=!1,oe=!0,re=!1,se=!0,ae=!1,le={},ce=null;const ue=hn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const he=hn({},["audio","video","img","source","image","track"]);let me=null;const fe=hn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",ye="http://www.w3.org/1999/xhtml";let be=ye,ve=!1,we=null;const Ee=hn({},[pe,ge,ye],tn);let Se=hn({},["mi","mo","mn","ms","mtext"]),_e=hn({},["annotation-xml"]);const xe=hn({},["title","style","font","a","script"]);let Te=null;const Ae=["application/xhtml+xml","text/html"];let Ce=null,ke=null;const Oe=i.createElement("form"),Ne=function(e){return e instanceof RegExp||e instanceof Function},Ie=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ke||ke!==e){if(e&&"object"==typeof e||(e={}),e=fn(e),Te=-1===Ae.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Ce="application/xhtml+xml"===Te?tn:en,z=an(e,"ALLOWED_TAGS")?hn({},e.ALLOWED_TAGS,Ce):q,F=an(e,"ALLOWED_ATTR")?hn({},e.ALLOWED_ATTR,Ce):U,we=an(e,"ALLOWED_NAMESPACES")?hn({},e.ALLOWED_NAMESPACES,tn):Ee,me=an(e,"ADD_URI_SAFE_ATTR")?hn(fn(fe),e.ADD_URI_SAFE_ATTR,Ce):fe,de=an(e,"ADD_DATA_URI_TAGS")?hn(fn(he),e.ADD_DATA_URI_TAGS,Ce):he,ce=an(e,"FORBID_CONTENTS")?hn({},e.FORBID_CONTENTS,Ce):ue,B=an(e,"FORBID_TAGS")?hn({},e.FORBID_TAGS,Ce):fn({}),H=an(e,"FORBID_ATTR")?hn({},e.FORBID_ATTR,Ce):fn({}),le=!!an(e,"USE_PROFILES")&&e.USE_PROFILES,$=!1!==e.ALLOW_ARIA_ATTR,Q=!1!==e.ALLOW_DATA_ATTR,K=e.ALLOW_UNKNOWN_PROTOCOLS||!1,V=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Y=e.SAFE_FOR_TEMPLATES||!1,J=!1!==e.SAFE_FOR_XML,X=e.WHOLE_DOCUMENT||!1,te=e.RETURN_DOM||!1,ne=e.RETURN_DOM_FRAGMENT||!1,ie=e.RETURN_TRUSTED_TYPE||!1,ee=e.FORCE_BODY||!1,oe=!1!==e.SANITIZE_DOM,re=e.SANITIZE_NAMED_PROPS||!1,se=!1!==e.KEEP_CONTENT,ae=e.IN_PLACE||!1,M=e.ALLOWED_URI_REGEXP||Rn,be=e.NAMESPACE||ye,Se=e.MATHML_TEXT_INTEGRATION_POINTS||Se,_e=e.HTML_INTEGRATION_POINTS||_e,G=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Ne(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ne(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(G.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Y&&(Q=!1),ne&&(te=!0),le&&(z=hn({},Sn),F=[],!0===le.html&&(hn(z,gn),hn(F,_n)),!0===le.svg&&(hn(z,yn),hn(F,xn),hn(F,An)),!0===le.svgFilters&&(hn(z,bn),hn(F,xn),hn(F,An)),!0===le.mathMl&&(hn(z,wn),hn(F,Tn),hn(F,An))),e.ADD_TAGS&&("function"==typeof e.ADD_TAGS?W.tagCheck=e.ADD_TAGS:(z===q&&(z=fn(z)),hn(z,e.ADD_TAGS,Ce))),e.ADD_ATTR&&("function"==typeof e.ADD_ATTR?W.attributeCheck=e.ADD_ATTR:(F===U&&(F=fn(F)),hn(F,e.ADD_ATTR,Ce))),e.ADD_URI_SAFE_ATTR&&hn(me,e.ADD_URI_SAFE_ATTR,Ce),e.FORBID_CONTENTS&&(ce===ue&&(ce=fn(ce)),hn(ce,e.FORBID_CONTENTS,Ce)),se&&(z["#text"]=!0),X&&hn(z,["html","head","body"]),z.table&&(hn(z,["tbody"]),delete B.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw cn('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw cn('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=e.TRUSTED_TYPES_POLICY,S=E.createHTML("")}else void 0===E&&(E=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:e=>e,createScriptURL:e=>e})}catch(r){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(f,r)),null!==E&&"string"==typeof S&&(S=E.createHTML(""));Ht&&Ht(e),ke=e}},Re=hn({},[...yn,...bn,...vn]),Le=hn({},[...wn,...En]),je=function(e){Xt(n.removed,{element:e});try{w(e).removeChild(e)}catch(t){y(e)}},Pe=function(e,t){try{Xt(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(i){Xt(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(te||ne)try{je(t)}catch(i){}else try{t.setAttribute(e,"")}catch(i){}},De=function(e){let t=null,n=null;if(ee)e="<remove></remove>"+e;else{const t=nn(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===Te&&be===ye&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const o=E?E.createHTML(e):e;if(be===ye)try{t=(new m).parseFromString(o,Te)}catch(s){}if(!t||!t.documentElement){t=_.createDocument(be,"template",null);try{t.documentElement.innerHTML=ve?S:o}catch(s){}}const r=t.body||t.documentElement;return e&&n&&r.insertBefore(i.createTextNode(n),r.childNodes[0]||null),be===ye?A.call(t,X?"html":"body")[0]:X?t.documentElement:r},Me=function(e){return x.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},ze=function(e){return e instanceof h&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},qe=function(e){return"function"==typeof l&&e instanceof l};function Fe(e,t,i){Vt(e,e=>{e.call(n,t,i,ke)})}const Ue=function(e){let t=null;if(Fe(k.beforeSanitizeElements,e,null),ze(e))return je(e),!0;const i=Ce(e.nodeName);if(Fe(k.uponSanitizeElement,e,{tagName:i,allowedTags:z}),J&&e.hasChildNodes()&&!qe(e.firstElementChild)&&ln(/<[/\w!]/g,e.innerHTML)&&ln(/<[/\w!]/g,e.textContent))return je(e),!0;if(e.nodeType===Fn)return je(e),!0;if(J&&e.nodeType===Un&&ln(/<[/\w]/g,e.data))return je(e),!0;if(!(W.tagCheck instanceof Function&&W.tagCheck(i))&&(!z[i]||B[i])){if(!B[i]&&Be(i)){if(G.tagNameCheck instanceof RegExp&&ln(G.tagNameCheck,i))return!1;if(G.tagNameCheck instanceof Function&&G.tagNameCheck(i))return!1}if(se&&!ce[i]){const t=w(e)||e.parentNode,n=v(e)||e.childNodes;if(n&&t){for(let i=n.length-1;i>=0;--i){const o=g(n[i],!0);o.__removalCount=(e.__removalCount||0)+1,t.insertBefore(o,b(e))}}}return je(e),!0}return e instanceof c&&!function(e){let t=w(e);t&&t.tagName||(t={namespaceURI:be,tagName:"template"});const n=en(e.tagName),i=en(t.tagName);return!!we[e.namespaceURI]&&(e.namespaceURI===ge?t.namespaceURI===ye?"svg"===n:t.namespaceURI===pe?"svg"===n&&("annotation-xml"===i||Se[i]):Boolean(Re[n]):e.namespaceURI===pe?t.namespaceURI===ye?"math"===n:t.namespaceURI===ge?"math"===n&&_e[i]:Boolean(Le[n]):e.namespaceURI===ye?!(t.namespaceURI===ge&&!_e[i])&&!(t.namespaceURI===pe&&!Se[i])&&!Le[n]&&(xe[n]||!Re[n]):!("application/xhtml+xml"!==Te||!we[e.namespaceURI]))}(e)?(je(e),!0):"noscript"!==i&&"noembed"!==i&&"noframes"!==i||!ln(/<\/no(script|embed|frames)/i,e.innerHTML)?(Y&&e.nodeType===qn&&(t=e.textContent,Vt([O,N,I],e=>{t=on(t,e," ")}),e.textContent!==t&&(Xt(n.removed,{element:e.cloneNode()}),e.textContent=t)),Fe(k.afterSanitizeElements,e,null),!1):(je(e),!0)},Ge=function(e,t,n){if(oe&&("id"===t||"name"===t)&&(n in i||n in Oe))return!1;if(Q&&!H[t]&&ln(R,t));else if($&&ln(L,t));else if(W.attributeCheck instanceof Function&&W.attributeCheck(t,e));else if(!F[t]||H[t]){if(!(Be(e)&&(G.tagNameCheck instanceof RegExp&&ln(G.tagNameCheck,e)||G.tagNameCheck instanceof Function&&G.tagNameCheck(e))&&(G.attributeNameCheck instanceof RegExp&&ln(G.attributeNameCheck,t)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(t,e))||"is"===t&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&ln(G.tagNameCheck,n)||G.tagNameCheck instanceof Function&&G.tagNameCheck(n))))return!1}else if(me[t]);else if(ln(M,on(n,P,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==rn(n,"data:")||!de[e]){if(K&&!ln(j,on(n,P,"")));else if(n)return!1}else;return!0},Be=function(e){return"annotation-xml"!==e&&nn(e,D)},He=function(e){Fe(k.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||ze(e))return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F,forceKeepAttr:void 0};let o=t.length;for(;o--;){const s=t[o],{name:a,namespaceURI:l,value:c}=s,u=Ce(a),d=c;let h="value"===a?d:sn(d);if(i.attrName=u,i.attrValue=h,i.keepAttr=!0,i.forceKeepAttr=void 0,Fe(k.uponSanitizeAttribute,e,i),h=i.attrValue,!re||"id"!==u&&"name"!==u||(Pe(a,e),h="user-content-"+h),J&&ln(/((--!?|])>)|<\/(style|title|textarea)/i,h)){Pe(a,e);continue}if("attributename"===u&&nn(h,"href")){Pe(a,e);continue}if(i.forceKeepAttr)continue;if(!i.keepAttr){Pe(a,e);continue}if(!V&&ln(/\/>/i,h)){Pe(a,e);continue}Y&&Vt([O,N,I],e=>{h=on(h,e," ")});const m=Ce(e.nodeName);if(Ge(m,u,h)){if(E&&"object"==typeof f&&"function"==typeof f.getAttributeType)if(l);else switch(f.getAttributeType(m,u)){case"TrustedHTML":h=E.createHTML(h);break;case"TrustedScriptURL":h=E.createScriptURL(h)}if(h!==d)try{l?e.setAttributeNS(l,a,h):e.setAttribute(a,h),ze(e)?je(e):Jt(n.removed)}catch(r){Pe(a,e)}}else Pe(a,e)}Fe(k.afterSanitizeAttributes,e,null)},We=function e(t){let n=null;const i=Me(t);for(Fe(k.beforeSanitizeShadowDOM,t,null);n=i.nextNode();)Fe(k.uponSanitizeShadowNode,n,null),Ue(n),He(n),n.content instanceof s&&e(n.content);Fe(k.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null,r=null,a=null,c=null;if(ve=!e,ve&&(e="\x3c!--\x3e"),"string"!=typeof e&&!qe(e)){if("function"!=typeof e.toString)throw cn("toString is not a function");if("string"!=typeof(e=e.toString()))throw cn("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Z||Ie(t),n.removed=[],"string"==typeof e&&(ae=!1),ae){if(e.nodeName){const t=Ce(e.nodeName);if(!z[t]||B[t])throw cn("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)i=De("\x3c!----\x3e"),r=i.ownerDocument.importNode(e,!0),r.nodeType===zn&&"BODY"===r.nodeName||"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!te&&!Y&&!X&&-1===e.indexOf("<"))return E&&ie?E.createHTML(e):e;if(i=De(e),!i)return te?null:ie?S:""}i&&ee&&je(i.firstChild);const u=Me(ae?e:i);for(;a=u.nextNode();)Ue(a),He(a),a.content instanceof s&&We(a.content);if(ae)return e;if(te){if(ne)for(c=T.call(i.ownerDocument);i.firstChild;)c.appendChild(i.firstChild);else c=i;return(F.shadowroot||F.shadowrootmode)&&(c=C.call(o,c,!0)),c}let d=X?i.outerHTML:i.innerHTML;return X&&z["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&ln(Pn,i.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+d),Y&&Vt([O,N,I],e=>{d=on(d,e," ")}),E&&ie?E.createHTML(d):d},n.setConfig=function(){Ie(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Z=!0},n.clearConfig=function(){ke=null,Z=!1},n.isValidAttribute=function(e,t,n){ke||Ie({});const i=Ce(e),o=Ce(t);return Ge(i,o,n)},n.addHook=function(e,t){"function"==typeof t&&Xt(k[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=Yt(k[e],t);return-1===n?void 0:Zt(k[e],n,1)[0]}return Jt(k[e])},n.removeHooks=function(e){k[e]=[]},n.removeAllHooks=function(){k={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function Hn(e,t){if(!e)return"";try{let n={};return t?(t.allowedTags&&(n.ALLOWED_TAGS=t.allowedTags),t.allowedAttributes&&(n.ALLOWED_ATTR=Object.values(t.allowedAttributes).flat()),t.allowedSchemes&&(n.ALLOWED_URI_REGEXP=new RegExp(`^(${t.allowedSchemes.join("|")}):`,"i")),void 0!==t.allowComments&&(n.ALLOWED_TAGS=n.ALLOWED_TAGS||[],t.allowComments&&n.ALLOWED_TAGS.push("#comment")),t.customElementHandlers&&(n.CUSTOM_ELEMENT_HANDLING={tagNameCheck:null,attributeNameCheck:null,allowCustomizedBuiltInElements:!0}),Bn.sanitize(e,n)):Bn.sanitize(e)}catch(n){return Ae.warn("Error sanitizing HTML:",n),String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}let Wn=null;function $n(e,t){}async function Qn({clientId:e}){var t;await(t="https://accounts.google.com/gsi/client",Wn||(Wn=new Promise((e,n)=>{if("undefined"!=typeof window){const t=window.google;if(t?.accounts?.id)return e(),void 0}if("undefined"==typeof document)return n(new Error("Google Identity Services requires a browser environment")),void 0;const i=console.warn,o=console.error,r=e=>!("string"!=typeof e||!e.includes("[GSI_LOGGER]"));console.warn=function(...e){r(e[0]?.toString())||i.apply(console,e)},console.error=function(...e){r(e[0]?.toString())||o.apply(console,e)};const s=document.createElement("script");s.src=t,s.async=!0,s.defer=!0,s.onload=()=>{e()},s.onerror=()=>{n(new Error("Failed to load Google Identity Services script"))},document.head.appendChild(s)}),Wn));const n=function(e=32){const t=new Uint8Array(e);return window.crypto.getRandomValues(t),btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}(32),i=window.google;return new Promise((t,o)=>{const r=setTimeout(()=>{o(new Error("GIS prompt callback timeout"))},15e3),s=setTimeout(()=>{o(new Error("Google One Tap timed out"))},4e4);try{if(!i?.accounts?.id)throw new Error("Google Identity Services not available on window.google");i.accounts.id.initialize({client_id:e,ux_mode:"popup",itp_support:!0,use_fedcm_for_prompt:!0,callback:e=>{try{$n(),e&&e.credential?(clearTimeout(r),clearTimeout(s),$n(),$n(),t({idToken:e.credential,nonce:n})):e&&e.error?(clearTimeout(r),clearTimeout(s),$n(),o(new Error(e.error))):$n()}catch(i){clearTimeout(r),clearTimeout(s),o(i)}},nonce:n}),i.accounts.id.prompt(e=>{try{if($n(0,(e?.isSkippedMoment?.(),e?.isDismissedMoment?.())),e?.isSkippedMoment?.())$n(),$n(),clearTimeout(r),clearTimeout(s),o(new Error("GIS skipped - FedCM unavailable. OAuth fallback will be attempted."));else if(e?.isDismissedMoment?.()){const t=e.getDismissedReason?.();if($n(),"credential_returned"===t)return $n(),void 0;clearTimeout(r),clearTimeout(s),o(new Error(`GIS dismissed: ${t||"unknown"}`))}else $n()}catch(t){$n(),clearTimeout(r),clearTimeout(s)}})}catch(a){clearTimeout(r),clearTimeout(s),o(a)}})}function Kn(e){const t=document.getElementById("auth-container");if(t){if(e){const n=De.profile?.role||"caricamento...",i=e.user.email;t.innerHTML=Hn(`\n            <div class="d-flex align-items-center text-light">\n                <span class="navbar-text me-3" title="${i}">\n                    <i class="material-icons me-1" style="font-size: 1.1em; vertical-align: text-bottom;">account_circle</i>\n                    ${i?.split("@")[0]||""}\n                </span>\n                <span class="badge bg-info me-3 text-uppercase" style="font-size: 0.75em; padding: 0.4em 0.6em;">\n                    ${n}\n                </span>\n                <button id="logout-button" class="btn btn-outline-light btn-sm">\n                    <i class="material-icons" style="font-size: 1em; vertical-align: middle;">logout</i>\n                </button>\n            </div>\n        `)}else t.innerHTML=Hn('\n            <button id="login-modal-trigger" class="btn btn-outline-light">\n                <i class="material-icons me-1" style="font-size: 1em;">login</i>\n                Accedi\n            </button>\n        ');Et()}}function Vn(){const e=document.getElementById("auth-modal");if(e){const t=i.getInstance(e);t&&t.hide()}}function Yn(){window.authUIListenersInitialized||(window.addEventListener("auth:session-changed",e=>{Kn(e.detail.session||null)}),void 0!==De&&Kn(De.session||null),void document.body.addEventListener("click",async e=>{const t=e.target;if(t.closest("#logout-button")&&(e.preventDefault(),await Fe()),t.closest("#login-modal-trigger")){e.preventDefault();const n=t;n.disabled=!0,(async()=>{try{const t="1096813530815-bk23h9jv77okogb6pb2k0mtqbb5fo1n0.apps.googleusercontent.com";if(1,t){Ae.info("ðŸš€ Tentativo login GIS diretto (skip incognito check)...");try{const{idToken:e,nonce:n}=await Qn({clientId:t}),{error:i}=await Re.auth.signInWithIdToken({provider:"google",token:e,nonce:n});if(i)throw Ae.warn("âŒ Errore Supabase signInWithIdToken:",i),i;return Ae.info("âœ… Login GIS completato con successo"),void 0}catch(e){Ae.warn("âŒ Errore GIS, fallback a OAuth")}}await qe(),Ae.info("âœ… Login OAuth completato")}catch(t){Ae.error("Errore durante l'accesso:",t),n.disabled=!1}})()}if(t.closest("#google-login-btn")){e.preventDefault(),Ae.log("Pulsante Google cliccato");const r=t.closest("#google-login-btn"),s=r.querySelector(".spinner-border"),a=r.querySelector(".material-icons");r.disabled=!0,s&&(s.style.display="inline-block"),a&&(a.style.display="none");try{const e="1096813530815-bk23h9jv77okogb6pb2k0mtqbb5fo1n0.apps.googleusercontent.com";if(1,e){Ae.info("ðŸš€ Tentativo login GIS (skip incognito check)..."),Ae.debug("ðŸ“‹ Dettagli dominio:",{origin:window.location.origin,hostname:window.location.hostname,href:window.location.href});try{Ae.debug("ðŸ”„ Chiamando getGoogleIdToken...");const{idToken:t,nonce:n}=await Qn({clientId:e});Ae.debug("âœ… Token GIS ottenuto:",{tokenLength:t?.length,nonceLength:n?.length,tokenPreview:t?.substring(0,20)+"..."}),Ae.debug("ðŸ”„ Tentativo login Supabase con GIS token...");const{error:i}=await Re.auth.signInWithIdToken({provider:"google",token:t,nonce:n});if(i)throw Ae.warn("âŒ Errore Supabase signInWithIdToken:",i),i;return Ae.info("âœ… Login GIS completato con successo"),Vn(),Ae.info("âœ… Login GIS completato, attendendo redirect automatico..."),void 0}catch(n){const e=n;Ae.warn("âŒ Errore GIS dettagliato:",{message:e.message,stack:e.stack,name:e.name,cause:e.cause});const t=document.getElementById("auth-error");t&&(t.innerHTML=Hn(`\n                <div>\n                  <strong>âš ï¸ Login Google non disponibile:</strong> ${e?.message||"Errore durante il login con Google"}\n                  <br><small class="mt-2">Ritentando con metodo alternativo...</small>\n                </div>\n              `),t.style.display="block"),0,Ae.info("ðŸ”„ Fallback a OAuth redirect...")}}await qe(),Vn(),Ae.info("âœ… Login OAuth completato, attendendo redirect automatico...")}catch(i){const e=i;Ae.error("Errore durante l'accesso:",i);const t=Ie({timestamp:(new Date).toISOString(),message:e?.message||"Unknown error",stack:e?.stack||"No stack trace",name:e?.name||"Unknown",cause:e?.cause||null,useGis:!0,hasClientId:!0,userAgent:navigator.userAgent,url:window.location.href,env:"production"});try{const e=JSON.parse(localStorage.getItem("auth_errors")||"[]");e.push(t),e.length>10&&e.shift(),localStorage.setItem("auth_errors",JSON.stringify(e)),window.lastAuthError=t}catch(o){Ae.warn("Failed to persist error details:",o)}const n=document.getElementById("auth-error");if(n){const t=e&&(e.message||e.error||e.toString())||"Errore durante l'accesso. Riprova.";n.textContent=t,n.style.display="block"}}finally{r.disabled=!1,s&&(s.style.display="none"),a&&(a.style.display="inline-block")}}}),window.authUIListenersInitialized=!0)}const Jn=new class{#E;#g;#h;#S;#_;#x;#T;#A;constructor(e={}){this.#E=e.queryCache||new ue,this.#g=e.mutationCache||new le,this.#h=e.defaultOptions||{},this.#S=new Map,this.#_=new Map,this.#x=0}mount(){this.#x++,1===this.#x&&(this.#T=B.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#E.onFocus())}),this.#A=Q.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#E.onOnline())}))}unmount(){this.#x--,0===this.#x&&(this.#T?.(),this.#T=void 0,this.#A?.(),this.#A=void 0)}isFetching(e){return this.#E.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#g.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#E.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=this.#E.build(this,t),i=n.state.data;return void 0===i?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(_(t.staleTime,n))&&void this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return this.#E.findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,n){const i=this.defaultQueryOptions({queryKey:e}),o=this.#E.get(i.queryHash),r=o?.state.data,s=function(e,t){return"function"==typeof e?e(t):e}(t,r);if(void 0!==s)return this.#E.build(this,i).setData(s,{...n,manual:!0})}setQueriesData(e,t,n){return $.batch(()=>this.#E.findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,n)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#E.get(t.queryHash)?.state}removeQueries(e){const t=this.#E;$.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const n=this.#E;return $.batch(()=>(n.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},i=$.batch(()=>this.#E.findAll(e).map(e=>e.cancel(n)));return Promise.all(i).then(w).catch(w)}invalidateQueries(e,t={}){return $.batch(()=>(this.#E.findAll(e).forEach(e=>{e.invalidate()}),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},i=$.batch(()=>this.#E.findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,n);return n.throwOnError||(t=t.catch(w)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(i).then(w)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const n=this.#E.build(this,t);return n.isStaleByTime(_(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(w).catch(w)}fetchInfiniteQuery(e){return e.behavior=ie(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(w).catch(w)}ensureInfiniteQueryData(e){return e.behavior=ie(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Q.isOnline()?this.#g.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#E}getMutationCache(){return this.#g}getDefaultOptions(){return this.#h}setDefaultOptions(e){this.#h=e}setQueryDefaults(e,t){this.#S.set(k(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#S.values()],n={};return t.forEach(t=>{O(e,t.queryKey)&&Object.assign(n,t.defaultOptions)}),n}setMutationDefaults(e,t){this.#_.set(k(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#_.values()],n={};return t.forEach(t=>{O(e,t.mutationKey)&&Object.assign(n,t.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#h.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=C(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===F&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#h.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#E.clear(),this.#g.clear()}},Xn=!1;Xn,window.currentUser=De,window.addEventListener("error",e=>{const t=Ie({...{timestamp:(new Date).toISOString(),context:"GLOBAL_ERROR",message:e.error?.message||e.message||"Unknown global error"}});try{const e=JSON.parse(localStorage.getItem("auth_errors")||"[]");e.push(t),e.length>10&&e.shift(),localStorage.setItem("auth_errors",JSON.stringify(e)),window.lastGlobalError=t}catch(n){Ae.warn("Failed to persist global error")}}),window.addEventListener("unhandledrejection",e=>{const t=Ie({...{timestamp:(new Date).toISOString(),context:"UNHANDLED_PROMISE",message:e.reason?.message||e.reason||"Unknown promise rejection"}});try{const e=JSON.parse(localStorage.getItem("auth_errors")||"[]");e.push(t),e.length>10&&e.shift(),localStorage.setItem("auth_errors",JSON.stringify(e)),window.lastPromiseError=t}catch(n){Ae.warn("Failed to persist promise error")}}),window.addEventListener("load",async function(){try{Ae.log(`ðŸš€ Inizializzazione ${_e} v${xe} (React)`),St(),Ue(),document.addEventListener("click",e=>{const t=e.target.closest(".btn-back-menu");if(t){e.preventDefault(),t.style.transform="scale(0.95)",t.style.transition="transform 0.1s ease",setTimeout(()=>{t.style.transform="",t.style.transition=""},150);const n=t.getAttribute("data-view")||"/home",i=n.startsWith("/")?n:`/${n}`;"/home"!==i&&"/"!==i||(sessionStorage.removeItem("editPazienteId"),sessionStorage.removeItem("formData"),sessionStorage.removeItem("currentFilters")),setTimeout(()=>{Ce?Ce(i):window.location.pathname=i},100)}}),function(){wt();const e=gt(wt,250);window.addEventListener("resize",e);const t=document.getElementById("auth-container");t&&new MutationObserver(Et).observe(t,{childList:!0,subtree:!0});setTimeout(Et,150),window.addEventListener("auth:session-changed",()=>{Et()})}(),await async function(e){Pe.init(),De.isLoading=!0;let t=null,n=null;for(let o=1;o<=3;o+=1)try{const{data:{session:e},error:i}=await Re.auth.getSession();if(!i){t=e;break}if(n=i,Ae.warn(`Tentativo ${o}/3 - Errore nel recupero sessione:`,i),o<3){await new Promise(e=>setTimeout(e,1e3*o));continue}}catch(i){if(n=i,Ae.warn(`Tentativo ${o}/3 - Errore critico:`,i),o<3){await new Promise(e=>setTimeout(e,1e3*o));continue}}n&&!t&&Ae.error("Fallimento definitivo nel recupero sessione dopo",3,"tentativi:",n),Ae.log("Sessione iniziale recuperata:",t),await ze(t),De.isLoading=!1,e?.(t??null),Re.auth.onAuthStateChange(async(t,n)=>{Ae.log("Auth event:",t,"Session:",n),"SIGNED_OUT"===t&&"error"===Pe.getAuthState().state&&Pe.clearCorruptedState(),n?.access_token!==De.session?.access_token&&(await ze(n),e?.(n))}),Ae.log("Sistema di autenticazione inizializzato")}(e=>{Ae.log("âœ… Autenticazione inizializzata",e?"con sessione":"senza sessione")}),Yn(),Ae.log("âœ… Auth event listeners inizializzati");const t=document.getElementById("app");if(!t)throw new Error("Root element #app not found");const n=h.createRoot(t);r.lazy(()=>p(()=>import("./index-BXAdmnwS.js"),[]).then(e=>({default:e.ReactQueryDevtools})));n.render(e.jsx(r.StrictMode,{children:e.jsxs(Rt,{defaultPosition:"top-right",children:[e.jsxs(me,{client:Jn,children:[e.jsx(pt,{}),!1]}),e.jsx(zt,{})]})})),Ae.log("âœ… React App montata con successo")}catch(t){Ae.error("âŒ Errore durante l'inizializzazione dell'applicazione:",t),document.body.innerHTML=Hn('\n      <div class="container mt-5">\n        <div class="alert alert-danger" role="alert">\n          <h4 class="alert-heading">Errore di inizializzazione</h4>\n          <p>Si Ã¨ verificato un errore durante l\'avvio dell\'applicazione.</p>\n          \n          <hr>\n          <p class="mb-0">Ricarica la pagina per riprovare.</p>\n        </div>\n      </div>\n    ')}});export{v as A,E as B,S as C,b as D,B as E,ee as F,D as G,Lt as H,g as S,p as _,Ee as a,Fe as b,Re as c,qe as d,he as e,ve as f,Qn as g,gt as h,R as i,k as j,M as k,Ae as l,ae as m,$ as n,w as o,G as p,Hn as q,kt as r,Ge as s,yt as t,we as u,At as v,Ct as w,H as x,x as y,_ as z};

import{j as e}from"./ui-vendor-S6RcKJ66.js";import{R as t,b as a}from"./react-vendor-Bp2pLdQf.js";import{D as n}from"./dropdownPositioner-CpLmXRgY.js";import{b as r,n as l,i as s}from"./CentralizedStatisticsService-CBpCaSti.js";const i=()=>{if("undefined"!=typeof window&&"undefined"!=typeof localStorage){const e=localStorage.getItem("theme");if("light"===e||"dark"===e)return e}return"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},c=t.forwardRef(({id:t,value:c,onChange:d,label:o,placeholder:u="gg/mm/aaaa",description:m,isDisabled:p=!1,isRequired:h=!1,isInvalid:g=!1,errorMessage:v,minValue:f,maxValue:k,size:x="md",className:w,inputClassName:b,allowInput:y=!0,clearable:j=!0,autoFocus:D=!1},N)=>{const[S,C]=a.useState(!1),[M,E]=a.useState(()=>i()),[$,L]=a.useState(()=>"undefined"!=typeof window&&window.innerWidth<=576),[Y,F]=a.useState(()=>{if(c){const[e,t]=c.split("-");return new Date(parseInt(e),parseInt(t)-1)}return new Date}),[I,A]=a.useState(null),[R,V]=a.useState(()=>c?r(c):""),[q,z]=a.useState(!1);a.useEffect(()=>{const e=window.matchMedia("(max-width: 576px)"),t=e=>{L(e.matches)};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}},[]),a.useEffect(()=>{const e=()=>{E(i())},t=t=>{"theme"!==t.key&&null!==t.key||e()};window.addEventListener("storage",t);const a=()=>{setTimeout(e,10)};document.addEventListener("theme-change",a),window.addEventListener("theme-change",a);const n=window.matchMedia("(prefers-color-scheme: dark)"),r=t=>{e()};return n.addEventListener("change",r),e(),()=>{window.removeEventListener("storage",t),document.removeEventListener("theme-change",a),window.removeEventListener("theme-change",a),n.removeEventListener("change",r)}},[]),a.useEffect(()=>{if(S&&N&&"current"in N&&N.current){const e=N.current,t=e?.querySelector(".datepicker-input-group"),a=e?.querySelector(".datepicker-calendar-popup");e&&t&&a&&n.calculateAndApply(e,t,a)}},[S,N]),a.useEffect(()=>{const e=e=>{"Escape"===e.key&&S&&(e.preventDefault(),C(!1))};if(S)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[S]),a.useEffect(()=>{const e=e=>{if(N&&"current"in N){const t=N.current;t&&!t.contains(e.target)&&C(!1)}};if(S&&N&&"current"in N&&N.current)return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[S,N]),a.useEffect(()=>{q||V(c?r(c):"")},[c,q]);const P={sm:"form-control-sm",md:"",lg:"form-control-lg"}[x],T=`datepicker-${x}`,B=a.useCallback(e=>{const t=e.target.value;if(V(t),z(!0),!t.trim())return d(null),void 0;const a=l(t);a&&s(a)&&d(a)},[d]),W=a.useCallback(()=>{z(!1);const e=R.trim();if(!e)return d(null),V(""),void 0;const t=l(e);t&&s(t)?(d(t),V(r(t))):V(c?r(c):"")},[R,c,d]),O=a.useCallback(()=>{z(!0)},[]),G=a.useCallback(e=>{const t=e.target.value;if(!t)return d(null),void 0;s(t)&&d(t)},[d]),K=a.useCallback(()=>{d(null),V(""),z(!1)},[d]),U=a.useCallback(e=>{const t=`${Y.getFullYear()}-${String(Y.getMonth()+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`;d(t),V(r(t)),C(!1),z(!1)},[Y,d]),H=a.useCallback(()=>{F(e=>new Date(e.getFullYear(),e.getMonth()-1))},[]),J=a.useCallback(()=>{F(e=>new Date(e.getFullYear(),e.getMonth()+1))},[]),Q=a.useMemo(()=>{const e=Y.getFullYear(),t=Y.getMonth(),a=new Date(e,t,1),n=new Date(e,t+1,0).getDate(),r=a.getDay(),l=[];for(let s=0;s<r;s++)l.push(null);for(let s=1;s<=n;s++)l.push(s);return l},[Y]),X=a.useMemo(()=>{const e=(new Date).getFullYear(),t=[];for(let a=e-100;a<=e+10;a++)t.push(a);return t},[]),Z=a.useMemo(()=>Array.from({length:12},(e,t)=>{const a=new Date(2025,t);return{value:t,label:new Intl.DateTimeFormat("it-IT",{month:"long"}).format(a)}}),[]),_=a.useCallback(e=>{const t=parseInt(e.target.value);F(e=>new Date(e.getFullYear(),t))},[]),ee=a.useCallback(e=>{const t=parseInt(e.target.value);F(e=>new Date(t,e.getMonth()))},[]),te=a.useCallback(e=>{if("Escape"===e.key&&S)e.preventDefault(),C(!1);else if(S&&"ArrowUp"===e.key)if(e.preventDefault(),I){const e=I-7;e>0&&A(e)}else A(1);else if(S&&"ArrowDown"===e.key)if(e.preventDefault(),I){const e=I+7;e<=31&&A(e)}else A(1);else if(S&&"ArrowLeft"===e.key){if(e.preventDefault(),I&&I>1)A(I-1);else if(1===I){const e=new Date(Y.getFullYear(),Y.getMonth(),0).getDate();F(new Date(Y.getFullYear(),Y.getMonth()-1)),A(e)}}else if(S&&"ArrowRight"===e.key){e.preventDefault();const t=new Date(Y.getFullYear(),Y.getMonth()+1,0).getDate();I&&I<t?A(I+1):I===t&&(F(new Date(Y.getFullYear(),Y.getMonth()+1)),A(1))}else if(S&&"Enter"===e.key&&I){e.preventDefault();const t=`${Y.getFullYear()}-${String(Y.getMonth()+1).padStart(2,"0")}-${String(I).padStart(2,"0")}`;d(t),C(!1),A(null)}},[S,I,Y,d]);return e.jsxs("div",{ref:N,className:`datepicker-wrapper ${T} datepicker-${M} ${w||""}`,children:[o&&e.jsxs("label",{className:"form-label",htmlFor:t,children:[o,h&&e.jsx("span",{className:"required-asterisk",children:"*"})]}),e.jsx("div",{className:"datepicker-input-group "+(g?"is-invalid":""),children:$?e.jsx("input",{id:t,type:"date",className:`form-control ${P} datepicker-input native-date-input ${b||""} ${g?"is-invalid":""}`,value:c||"",onChange:G,disabled:p,autoFocus:D,min:f?String(f):void 0,max:k?String(k):void 0}):e.jsxs(e.Fragment,{children:[e.jsx("input",{id:t,type:"text",className:`form-control ${P} datepicker-input ${b||""} ${g?"is-invalid":""}`,placeholder:u,value:R,onChange:B,onBlur:W,onFocus:O,onKeyDown:te,disabled:p,autoFocus:D,readOnly:!y}),e.jsx("button",{type:"button",className:"datepicker-trigger-btn",onClick:()=>C(!S),disabled:p,"aria-label":"Apri date picker",children:e.jsxs("svg",{className:"datepicker-icon",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}),j&&R&&e.jsx("button",{type:"button",className:"datepicker-clear-btn",onClick:K,disabled:p,"aria-label":"Cancella data",children:e.jsxs("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}),m&&e.jsx("small",{className:"form-text",children:m}),g&&v&&e.jsx("div",{className:"invalid-feedback d-block",children:v}),S&&!p&&!$&&e.jsx("div",{className:"datepicker-calendar-popup",children:e.jsxs("div",{className:"datepicker-calendar",children:[e.jsxs("div",{className:"datepicker-calendar-header",children:[e.jsx("button",{type:"button",className:"datepicker-nav-btn datepicker-nav-prev",onClick:H,"aria-label":"Mese precedente",children:"←"}),e.jsxs("div",{className:"datepicker-dropdown-controls",children:[e.jsx("select",{className:"datepicker-month-select",value:Y.getMonth(),onChange:_,"aria-label":"Seleziona mese",children:Z.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("select",{className:"datepicker-year-select",value:Y.getFullYear(),onChange:ee,"aria-label":"Seleziona anno",children:X.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx("button",{type:"button",className:"datepicker-nav-btn datepicker-nav-next",onClick:J,"aria-label":"Mese successivo",children:"→"})]}),e.jsxs("table",{className:"datepicker-calendar-grid",children:[e.jsx("thead",{children:e.jsx("tr",{children:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"].map(t=>e.jsx("th",{className:"datepicker-weekday",children:t},t))})}),e.jsx("tbody",{children:Array.from({length:Math.ceil(Q.length/7)},(t,a)=>e.jsx("tr",{className:"datepicker-week",children:Array.from({length:7},(t,n)=>{const r=Q[7*a+n];if(null===r)return e.jsx("td",{className:"datepicker-day-cell"},n);const l=`${Y.getFullYear()}-${String(Y.getMonth()+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`,s=c===l,i=l===(new Date).toISOString().split("T")[0];return e.jsx("td",{className:"datepicker-day-cell",children:e.jsx("button",{type:"button",className:`datepicker-day ${s?"selected":""} ${i?"today":""} ${I===r?"focused":""}`,onClick:()=>U(r),children:r})},n)})},a))})]})]})})]})});c.displayName="DatePicker";const d=t.forwardRef(({startDate:t,endDate:a,onStartDateChange:n,onEndDateChange:r,startLabel:l="Start Date",endLabel:s="End Date",startPlaceholder:i="DD/MM/YYYY",endPlaceholder:d="DD/MM/YYYY",description:o,isDisabled:u=!1,isRequired:m=!1,isInvalid:p=!1,errorMessage:h,minValue:g,maxValue:v,size:f="md",className:k,allowInput:x=!0,clearable:w=!0},b)=>{const y=(()=>{if(!t||!a)return!0;try{const e=new Date(t);return e<=new Date(a)}catch{return!1}})(),j=p||!y;return e.jsxs("div",{ref:b,className:`date-range-picker-wrapper ${k||""}`,"aria-describedby":o?"daterange-description":void 0,children:[o&&e.jsx("p",{id:"daterange-description",className:"form-text mb-2",children:o}),e.jsxs("div",{className:"date-range-inputs",children:[e.jsx("div",{className:"date-range-input-group",children:e.jsx(c,{value:t,onChange:n,label:l,placeholder:i,isDisabled:u,isRequired:m,minValue:g,maxValue:v,size:f,allowInput:x,clearable:w,isInvalid:j})}),e.jsx("div",{className:"date-range-separator",children:"→"}),e.jsx("div",{className:"date-range-input-group",children:e.jsx(c,{value:a,onChange:r,label:s,placeholder:d,isDisabled:u,isRequired:m,minValue:g,maxValue:v,size:f,allowInput:x,clearable:w,isInvalid:j})})]}),j&&!y&&e.jsx("div",{className:"invalid-feedback d-block",children:"La data di inizio deve essere prima della data di fine"}),j&&h&&e.jsx("div",{className:"invalid-feedback d-block",children:h})]})});d.displayName="DateRangePicker";export{c as D,d as a};
